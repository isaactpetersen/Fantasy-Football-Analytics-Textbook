<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>12&nbsp; Causal Inference – Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cognitive-bias.html" rel="next">
<link href="./mixed-models.html" rel="prev">
<link href="./images/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-C3SNF7Y0PJ"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-C3SNF7Y0PJ', { 'anonymize_ip': true});
</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="12&nbsp; Causal Inference – Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R">
<meta property="og:description" content="">
<meta property="og:site_name" content="Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R">
<meta name="twitter:title" content="12&nbsp; Causal Inference – Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./causal-inference.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Causal Inference</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fantasy-football.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro to Football and Fantasy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting Started with <code>R</code> for Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./player-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Player Evaluation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./draft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Fantasy Draft</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Research Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Basic Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlation Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mixed-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mixed Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal-inference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Causal Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cognitive-bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Heuristics and Cognitive Biases in Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./actuarial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Judgment Versus Actuarial Approaches to Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-rates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Base Rates</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluating-prediction-accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Evaluation of Prediction/Forecasting Accuracy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mythbusters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Mythbusters: Putting Fantasy Football Beliefs/Anecdotes to the Test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modern-portfolio-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modern Portfolio Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-causalInferenceGettingStarted" id="toc-sec-causalInferenceGettingStarted" class="nav-link active" data-scroll-target="#sec-causalInferenceGettingStarted"><span class="header-section-number">12.1</span> Getting Started</a>
  <ul>
<li><a href="#sec-causalInferenceLoadPackages" id="toc-sec-causalInferenceLoadPackages" class="nav-link" data-scroll-target="#sec-causalInferenceLoadPackages"><span class="header-section-number">12.1.1</span> Load Packages</a></li>
  </ul>
</li>
  <li><a href="#sec-correlationCausality" id="toc-sec-correlationCausality" class="nav-link" data-scroll-target="#sec-correlationCausality"><span class="header-section-number">12.2</span> Correlation Does Not Imply Causation</a></li>
  <li><a href="#sec-conditionsForCausality" id="toc-sec-conditionsForCausality" class="nav-link" data-scroll-target="#sec-conditionsForCausality"><span class="header-section-number">12.3</span> Criteria for Causality</a></li>
  <li>
<a href="#sec-approachesCausalInference" id="toc-sec-approachesCausalInference" class="nav-link" data-scroll-target="#sec-approachesCausalInference"><span class="header-section-number">12.4</span> Approaches for Causal Inference</a>
  <ul>
<li><a href="#sec-causalInferenceExperiment" id="toc-sec-causalInferenceExperiment" class="nav-link" data-scroll-target="#sec-causalInferenceExperiment"><span class="header-section-number">12.4.1</span> Experimental Designs</a></li>
  <li>
<a href="#sec-causalInferenceQuasiExperiment" id="toc-sec-causalInferenceQuasiExperiment" class="nav-link" data-scroll-target="#sec-causalInferenceQuasiExperiment"><span class="header-section-number">12.4.2</span> Quasi-Experimental Designs</a>
  <ul class="collapse">
<li><a href="#sec-causalInferenceLongitudinal" id="toc-sec-causalInferenceLongitudinal" class="nav-link" data-scroll-target="#sec-causalInferenceLongitudinal"><span class="header-section-number">12.4.2.1</span> Longitudinal Designs</a></li>
  <li><a href="#sec-causalInferenceWithinSubject" id="toc-sec-causalInferenceWithinSubject" class="nav-link" data-scroll-target="#sec-causalInferenceWithinSubject"><span class="header-section-number">12.4.2.2</span> Within-Subject Analyses</a></li>
  <li><a href="#sec-causalInferenceControlVariables" id="toc-sec-causalInferenceControlVariables" class="nav-link" data-scroll-target="#sec-causalInferenceControlVariables"><span class="header-section-number">12.4.2.3</span> Control Variables</a></li>
  <li><a href="#sec-causalInferenceGeneticallyInformed" id="toc-sec-causalInferenceGeneticallyInformed" class="nav-link" data-scroll-target="#sec-causalInferenceGeneticallyInformed"><span class="header-section-number">12.4.2.4</span> Genetically Informed Designs</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-causalDiagrams" id="toc-sec-causalDiagrams" class="nav-link" data-scroll-target="#sec-causalDiagrams"><span class="header-section-number">12.5</span> Causal Diagrams</a>
  <ul>
<li><a href="#sec-causalDiagramsOverview" id="toc-sec-causalDiagramsOverview" class="nav-link" data-scroll-target="#sec-causalDiagramsOverview"><span class="header-section-number">12.5.1</span> Overview</a></li>
  <li><a href="#sec-causalDiagramConfounding" id="toc-sec-causalDiagramConfounding" class="nav-link" data-scroll-target="#sec-causalDiagramConfounding"><span class="header-section-number">12.5.2</span> Confounding</a></li>
  <li>
<a href="#sec-causalDiagramMediation" id="toc-sec-causalDiagramMediation" class="nav-link" data-scroll-target="#sec-causalDiagramMediation"><span class="header-section-number">12.5.3</span> Mediation</a>
  <ul class="collapse">
<li><a href="#sec-causalDiagramMediationFull" id="toc-sec-causalDiagramMediationFull" class="nav-link" data-scroll-target="#sec-causalDiagramMediationFull"><span class="header-section-number">12.5.3.1</span> Full Mediation</a></li>
  <li><a href="#sec-causalDiagramMediationPartial" id="toc-sec-causalDiagramMediationPartial" class="nav-link" data-scroll-target="#sec-causalDiagramMediationPartial"><span class="header-section-number">12.5.3.2</span> Partial Mediation</a></li>
  </ul>
</li>
  <li><a href="#sec-ancestorsDescendants" id="toc-sec-ancestorsDescendants" class="nav-link" data-scroll-target="#sec-ancestorsDescendants"><span class="header-section-number">12.5.4</span> Ancestors and Descendants</a></li>
  <li>
<a href="#sec-colliderBias" id="toc-sec-colliderBias" class="nav-link" data-scroll-target="#sec-colliderBias"><span class="header-section-number">12.5.5</span> Collider Bias</a>
  <ul class="collapse">
<li><a href="#sec-causalDiagramMBias" id="toc-sec-causalDiagramMBias" class="nav-link" data-scroll-target="#sec-causalDiagramMBias"><span class="header-section-number">12.5.5.1</span> M-Bias</a></li>
  <li><a href="#sec-butterflyBias" id="toc-sec-butterflyBias" class="nav-link" data-scroll-target="#sec-butterflyBias"><span class="header-section-number">12.5.5.2</span> Butterfly Bias</a></li>
  </ul>
</li>
  <li><a href="#sec-causalDiagramSelectionBias" id="toc-sec-causalDiagramSelectionBias" class="nav-link" data-scroll-target="#sec-causalDiagramSelectionBias"><span class="header-section-number">12.5.6</span> Selection Bias</a></li>
  </ul>
</li>
  <li><a href="#sec-causalInferenceConclusion" id="toc-sec-causalInferenceConclusion" class="nav-link" data-scroll-target="#sec-causalInferenceConclusion"><span class="header-section-number">12.6</span> Conclusion</a></li>
  <li><a href="#sec-causalInferenceSessionInfo" id="toc-sec-causalInferenceSessionInfo" class="nav-link" data-scroll-target="#sec-causalInferenceSessionInfo"><span class="header-section-number">12.7</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/edit/main/causal-inference.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><div class="alert alert-info hints-alert">
  <div class="hints-icon">
    <i class="fa fa-comments-o"></i>
  </div>
  <div class="hints-container">
    <b>I need your help!</b>
    <p>
    I want your feedback to make the book better for you and other readers. If you find typos, errors, or places where the text may be improved, please let me know.
    The best ways to provide feedback are by <a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook">GitHub</a> or <a href="https://hypothes.is">hypothes.is</a> annotations.
    </p>

    <p>
      <i class="fa fa-github"></i>
      <a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/issues">Opening an issue</a> or <a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/pulls">submitting a pull request</a> on GitHub: <a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook">https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook</a>
    </p>
    <p>
      <img style="display: inline;" src="https://hypothes.is/organizations/__default__/logo" alt="Hypothesis">
      Adding an annotation using <a href="https://hypothes.is">hypothes.is</a>.
      To add an annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class="annotator-adder-actions__icon"><path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"></path></svg></span>
      symbol on the pop-up menu.
      To see the annotations of others, click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class=""><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 12L6 8l4-4"></path></g></svg></span>
      symbol in the upper right-hand corner of the page.
    </p>
  </div>
</div>

<header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-causalInference" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Causal Inference</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="sec-causalInferenceGettingStarted" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="sec-causalInferenceGettingStarted">
<span class="header-section-number">12.1</span> Getting Started</h2>
<section id="sec-causalInferenceLoadPackages" class="level3" data-number="12.1.1"><h3 data-number="12.1.1" class="anchored" data-anchor-id="sec-causalInferenceLoadPackages">
<span class="header-section-number">12.1.1</span> Load Packages</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(<span class="st">"dagitty"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(<span class="st">"ggdag"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="sec-correlationCausality" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-correlationCausality">
<span class="header-section-number">12.2</span> Correlation Does Not Imply Causation</h2>
<p>As described in <a href="research-methods.html#sec-correlationCausation" class="quarto-xref"><span>Section 7.3.2.1</span></a>, there are several reasons why two variables, <code>X</code> and <code>Y</code>, might be correlated:</p>
<ul>
<li>
<code>X</code> causes <code>Y</code>
</li>
<li>
<code>Y</code> causes <code>X</code>
</li>
<li>
<code>X</code> and <code>Y</code> are bidirectional: <code>X</code> causes <code>Y</code> and <code>Y</code> causes <code>X</code>
</li>
<li>a third variable (i.e., <a href="#sec-causalDiagramConfounding">confound</a>), <code>Z</code>, influences both <code>X</code> and <code>Y</code>
</li>
<li>the association between <code>X</code> and <code>Y</code> is spurious</li>
</ul></section><section id="sec-conditionsForCausality" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="sec-conditionsForCausality">
<span class="header-section-number">12.3</span> Criteria for Causality</h2>
<p>How do we know whether two processes are causally related? There are three criteria for establishing causality <span class="citation" data-cites="Shadish2002">(<a href="references.html#ref-Shadish2002" role="doc-biblioref">Shadish et al., 2002</a>)</span>:</p>
<ol type="1">
<li>The cause (e.g., the independent or predictor variable) temporally precedes the effect (i.e., the dependent or outcome variable).</li>
<li>The cause is related to (i.e., associated with) the effect.</li>
<li>There are no other alternative explanations for the effect apart from the cause.</li>
</ol>
<p>The first criterion for establishing causality involves temporal precedence. In order for a cause to influence an effect, the cause must occur before the effect. For instance, if sports drink consumption influences player performance, the sports drink consumption (that is presumed to influence performance) must occur prior to the performance improvement. Establishing the first criterion eliminates the possibility that the association between the purported cause and effect reflects reverse causation. Reverse causation occurs when the purported effect is actually the cause of the purported cause, rather than the other way around. For instance, if sports drink consumption occurs only once, and it occurs only before and not after performance, then we have ruled out the possibility of reverse causation (i.e., that better performance causes players to consume sports drink).</p>
<p>The second criterion involves association. The purported cause must be associated with the purported effect. Nevertheless, as the maxim goes, “correlation does not imply causation.” Just because two variables are correlated does not necessarily mean that they are causally related. However, correlation is useful because causality requires that the two processes be correlated. That is, correlation is a necessary but insufficient condition for causality. For instance, if sports drink consumption influences player performance, sports drink consumption must be associated with performance improvement.</p>
<p>The third criterion involves ruling out alternative reasons why the purported cause and effect may be related. As noted in <a href="#sec-correlationCausality" class="quarto-xref"><span>Section 12.2</span></a>, there are four reasons why <code>X</code> may be correlated with <code>Y</code>. If we meet the first criterion of causality, we have removed the possibility that <code>Y</code> causes <code>X</code> (i.e., reverse causality). To meet the third criterion of causality, we need to remove the possibility that the association reflects a third variable (<a href="#sec-causalDiagramConfounding">confound</a>) that influences both the cause and effect, and we need to remove the possibility that the association is spurious—the possibility that the association between the purported cause and effect is due to random chance.</p>
<p>There are multiple approaches to meeting the third criterion of causality, such as by use of <a href="#sec-causalInferenceExperiment">experiments</a>, <a href="#sec-causalInferenceLongitudinal">longitudinal designs</a>, <a href="#sec-causalInferenceControlVariables">control variables</a>, <a href="#sec-causalInferenceWithinSubject">within-subject designs</a>, and <a href="#sec-causalInferenceGeneticallyInformed">genetically informed designs</a>, as described in <a href="#sec-approachesCausalInference" class="quarto-xref"><span>Section 12.4</span></a>.</p>
<p>In general, to meet the third criterion of causality, one must consider the counterfactual. A <em>counterfactual</em> is what would have happened in the hypothetical scenario that the cause did not occur [i.e., what would have happened in the absence of the cause; <span class="citation" data-cites="Shadish2002">Shadish et al. (<a href="references.html#ref-Shadish2002" role="doc-biblioref">2002</a>)</span>]. When engaging in causal inference, it is important to consider what would have happened if the hypothetical cause had actually not occurred. For instance, consider that we conduct an experiment to randomly assign some players to consume a sports drink before a game and other players to drink only water. In this case, our treatment/intervention group is the group of players that consumed a sports drink. The control group is the group players that drank only water. Now, consider that the players in the treatment group outperform the players in the the control group in their football game. In such a study, we observe what <em>did happen</em> when players received a treatment. The counterfactual is knowledge of what <em>would have happened</em> to those same players if they simultaneously had not received treatment <span class="citation" data-cites="Shadish2002">(<a href="references.html#ref-Shadish2002" role="doc-biblioref">Shadish et al., 2002</a>)</span>. The true causal effect, then, is the difference between what did happen and what would have happened. However, we cannot observe a counterfactual. That is, we do not know for sure what would have happened to the players who received treatment if those same players had actually not received treatment. We have a control group, but the control group does not have the same players as the intervention group, and it is impossible for a person to simultaneously receive and not receive treatment.</p>
<p>So, our goal in working toward causal inference as scientists is to create reasonable approximations to this impossible counterfactual <span class="citation" data-cites="Shadish2002">(<a href="references.html#ref-Shadish2002" role="doc-biblioref">Shadish et al., 2002</a>)</span>. For instance, if using a <a href="research-methods.html#sec-betweenSubject">between-subject design</a>, we want the two groups to be equivalent in every possible way except whether or not they receive the treatment, so we might stratify each group to be equivalent in terms of age, weight, position, experience, skill, etc. Or, we might test the same people using an A-B-A-B <a href="research-methods.html#sec-withinSubject">within-subject design</a>. In an A-B-A-B <a href="research-methods.html#sec-withinSubject">within-subject design</a>, players receive no treatment at baseline (timepoint 1: game 1), receive the treatment at timepoint 2 (game 2), receive no treatment at timepoint 3 (game 3), and receive the treatment at timepoint 4 (game 4). Neither of these approximations is a true counterfactual. In the <a href="research-methods.html#sec-betweenSubject">between-subject design</a>, the players differ between the two groups, so we cannot know how the individuals who received the treatment would have performed if they had actually not received the treatment. In the A-B-A-B <a href="research-methods.html#sec-withinSubject">within-subject design</a>, the players are the same, but they timepoints that they receive or do not receive the treatment differ, and there can be <a href="research-methods.html#sec-withinSubject">carryover effects</a> from one condition to the next. For instance, consuming sports drinks before game 2 might also help them be better hydrated in general, including, for subsequent games. Thus, we cannot know how a player would have performed in game 1 with treatment or in game 2 without treatment, etc. Nevertheless, it is important to be aware of the counterfactual and to engage in counterfactual reasoning to consider what would have happened if the supposed cause had not occurred. Considering the counterfactual is important for designing closer approximations to the counterfactual in studies for stronger research designs and stronger causal inference.</p>
</section><section id="sec-approachesCausalInference" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-approachesCausalInference">
<span class="header-section-number">12.4</span> Approaches for Causal Inference</h2>
<section id="sec-causalInferenceExperiment" class="level3" data-number="12.4.1"><h3 data-number="12.4.1" class="anchored" data-anchor-id="sec-causalInferenceExperiment">
<span class="header-section-number">12.4.1</span> Experimental Designs</h3>
<p>As described in <a href="research-methods.html#sec-experiment" class="quarto-xref"><span>Section 7.3.1</span></a>, <a href="research-methods.html#sec-experiment">experimental designs</a> are designs in which participants are randomly assigned to one or more levels of the <a href="research-methods.html#sec-experiment">independent variable</a> to observe its effects on the <a href="research-methods.html#sec-experiment">dependent variable</a>. <a href="research-methods.html#sec-experiment">Experimental designs</a> provide the strongest tests of causality because they can rule out reverse causation and third variables. For instance, by manipulating sports drink consumption before the player performs, they can eliminate the possibility that reverse causation explains the effect of the <a href="research-methods.html#sec-experiment">independent variable</a> on the <a href="research-methods.html#sec-experiment">dependent variable</a>. Second, through randomly assigning players to consume or not consume sports drink, this holds everything else constant (so long as the groups are evenly distributed according to other factors, such as their age, weight, etc.) and thus removes the possibility that third variable <a href="#sec-causalDiagramConfounding">confounds</a> explain the effect of the <a href="research-methods.html#sec-experiment">independent variable</a> on the <a href="research-methods.html#sec-experiment">dependent variable</a>.</p>
</section><section id="sec-causalInferenceQuasiExperiment" class="level3" data-number="12.4.2"><h3 data-number="12.4.2" class="anchored" data-anchor-id="sec-causalInferenceQuasiExperiment">
<span class="header-section-number">12.4.2</span> Quasi-Experimental Designs</h3>
<p>Although <a href="#sec-causalInferenceExperiment">experimental designs</a> provide the strongest tests of causality, manytimes they are impossible, unethical, or impractical to conduct. For instance, it would likely not be practical to randomly assign National Football League (NFL) players to either consume or not consume sports drink before their games. Players have their pregame rituals and routines and many would likely not agree to participate in such a study. Thus, we often rely on quasi-experimental designs such as natural experiments and <a href="research-methods.html#sec-correlationalStudy">observational/correlational designs</a>.</p>
<p>We cannot directly test or establish causality from a non-experimental research design. Nevertheless, we can leverage various design features that, in combination with other studies using different research methods, collectively strengthen our ability to make causal inferences. For instance, there are are no experiments in humans showing that smoking causes cancer—randomly assigning people to smoke or not smoke would not be ethical. The causal inference that smoking causes cancer was derived from a combination of experimental studies in rodents and observational studies in humans.</p>
<section id="sec-causalInferenceLongitudinal" class="level4" data-number="12.4.2.1"><h4 data-number="12.4.2.1" class="anchored" data-anchor-id="sec-causalInferenceLongitudinal">
<span class="header-section-number">12.4.2.1</span> Longitudinal Designs</h4>
<p>Research designs can be compared in terms of their <a href="research-methods.html#sec-internalValidity">internal validity</a>—the extent to which we can be confident about causal inferences. A cross-sectional association is depicted in <a href="#fig-crossSectional" class="quarto-xref">Figure&nbsp;<span>12.1</span></a>:</p>
<div id="fig-crossSectional" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-crossSectional-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Longitudinal-01.png" class="img-fluid figure-img" style="width:20.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crossSectional-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: Cross-Sectional Association. T1 = Timepoint 1. From <span class="citation" data-cites="Petersen2024a">Petersen (<a href="references.html#ref-Petersen2024a" role="doc-biblioref">2024a</a>)</span> and <span class="citation" data-cites="PetersenPrinciplesPsychAssessment">Petersen (<a href="references.html#ref-PetersenPrinciplesPsychAssessment" role="doc-biblioref">2024b</a>)</span>.
</figcaption></figure>
</div>
<p>For instance, we might observe that sports drink consumptions is concurrently associated with better player performance. Among <a href="research-methods.html#sec-correlationalStudy">observational/correlational research designs</a>, <a href="research-methods.html#sec-crossSectional">cross-sectional designs</a> tend to have the weakest <a href="research-methods.html#sec-internalValidity">internal validity</a>. For the reasons described in <a href="#sec-correlationCausality" class="quarto-xref"><span>Section 12.2</span></a>, if we observe a cross-sectional association between <code>X</code> (e.g., sports drink consumption) and <code>Y</code> (e.g., player performance), we have little confidence that <code>X</code> causes <code>Y</code>. As a result, <a href="research-methods.html#sec-longitudinal">longitudinal designs</a> can be valuable for more closely approximating causality if an <a href="#sec-causalInferenceExperiment">experimental designs</a> is not possible. Consider a lagged association that might be observed in a <a href="research-methods.html#sec-longitudinal">longitudinal design</a>, as in <a href="#fig-laggedAssociation" class="quarto-xref">Figure&nbsp;<span>12.2</span></a>, which is a slightly better approach than relying on cross-sectional associations:</p>
<div id="fig-laggedAssociation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-laggedAssociation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Longitudinal-02.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-laggedAssociation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: Lagged Association. T1 = Timepoint 1. T2 = Timepoint 2. From <span class="citation" data-cites="Petersen2024a">Petersen (<a href="references.html#ref-Petersen2024a" role="doc-biblioref">2024a</a>)</span> and <span class="citation" data-cites="PetersenPrinciplesPsychAssessment">Petersen (<a href="references.html#ref-PetersenPrinciplesPsychAssessment" role="doc-biblioref">2024b</a>)</span>.
</figcaption></figure>
</div>
<p>For instance, we might observe that sports drink performance <em>before</em> the game is associated with better player performance <em>during</em> the game. A lagged association has somewhat better <a href="research-methods.html#sec-internalValidity">internal validity</a> than a cross-sectional association because we have greater evidence of temporal precedence—that the influence of the predictor <em>precedes</em> the outcome because the predictor was assessed before the outcome and it shows a predictive association. However, part of the association between the predictor with later levels of the outcome could be due to prior levels of the outcome that are stable across time. That is, it could be that better player performance leads players to consume more sports drink and that player performance is relatively stable across time. In such a case, it may be observed that sports drink consumption predicts later player performance even though player performance influences sports drink consumption, rather than the other way around Thus, consider an even stronger alternative—a lagged association that controls for prior levels of the outcome, as in <a href="#fig-laggedAssociationControlPriorLevels" class="quarto-xref">Figure&nbsp;<span>12.3</span></a>:</p>
<div id="fig-laggedAssociationControlPriorLevels" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-laggedAssociationControlPriorLevels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Longitudinal-03.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-laggedAssociationControlPriorLevels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: Lagged Association, Controlling for Prior Levels of the Outcome. T1 = Timepoint 1. T2 = Timepoint 2. From <span class="citation" data-cites="Petersen2024a">Petersen (<a href="references.html#ref-Petersen2024a" role="doc-biblioref">2024a</a>)</span> and <span class="citation" data-cites="PetersenPrinciplesPsychAssessment">Petersen (<a href="references.html#ref-PetersenPrinciplesPsychAssessment" role="doc-biblioref">2024b</a>)</span>.
</figcaption></figure>
</div>
<p>For instance, we might observe that sports drink performance <em>before</em> the game is associated with better player performance <em>during</em> the game, while controlling for prior player performance. A lagged association controlling for prior levels of the outcome has better <a href="research-methods.html#sec-internalValidity">internal validity</a> than a lagged association that does not control for prior levels of the outcome. A lagged association that controls for prior levels further reduces the likelihood that the association owes to the reverse direction of effect, because earlier levels of the outcome are controlled. However, consider an even stronger alternative—lagged associations that control for prior levels of the outcome and that simultaneously test each direction of effect, as depicted in <a href="#fig-crossLaggedPanelModel" class="quarto-xref">Figure&nbsp;<span>12.4</span></a>:</p>
<div id="fig-crossLaggedPanelModel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-crossLaggedPanelModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Longitudinal-04.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crossLaggedPanelModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: Lagged Association, Controlling for Prior Levels of the Outcome, Simultaneously Testing Both Directions Of Effect. T1 = Timepoint 1. T2 = Timepoint 2. From <span class="citation" data-cites="Petersen2024a">Petersen (<a href="references.html#ref-Petersen2024a" role="doc-biblioref">2024a</a>)</span> and <span class="citation" data-cites="PetersenPrinciplesPsychAssessment">Petersen (<a href="references.html#ref-PetersenPrinciplesPsychAssessment" role="doc-biblioref">2024b</a>)</span>.
</figcaption></figure>
</div>
<p>Lagged associations that control for prior levels of the outcome and that simultaneously test each direction of effect provide the strongest <a href="research-methods.html#sec-internalValidity">internal validity</a> among <a href="research-methods.html#sec-correlationalStudy">observational/correlational designs</a>. Such a design can help better clarify which among the variables is the chicken and the egg—which variable is more likely to be the cause and which is more likely to be the effect. If there are bidirectional effects, such a design can also help clarify the magnitude of each direction of effect. For instance, we can simultaneously evaluate the extent to which sports drink predicts later player performance (while controlling for prior performance) and the reverse—player performance predicting later sports drink consumption (while contorlling for prior sports drink consumption).</p>
</section><section id="sec-causalInferenceWithinSubject" class="level4" data-number="12.4.2.2"><h4 data-number="12.4.2.2" class="anchored" data-anchor-id="sec-causalInferenceWithinSubject">
<span class="header-section-number">12.4.2.2</span> Within-Subject Analyses</h4>
<p>Another design feature of <a href="#sec-causalInferenceLongitudinal">longitudinal designs</a> that can lead to greater <a href="research-methods.html#sec-internalValidity">internal validity</a> is the use of within-subject analyses. Between-subject analyses, might examine, for instanc, whether players who consume more sports drink perform better on average compared to players who consume less sports drink. However, there are other between-person differences that could explain any observed between-subject associations between sports drink consumption and players performance. Another approach could be to apply within-subject analyses. For instance, you could examining whether, within the same individual, if a player consumes a sports drink, do they perform better compared to games in which they did not consume a sports drink. When we control for prior levels of the outcome in the prediction, we are evaluating whether the predictor is associated with witin-person <em>change</em> in the outcome. Predicting within-person change provides stronger evidence consistent with causality because it uses the individual as their own control and controls for many time-invariant <a href="#sec-causalDiagramConfounding">confounds</a> (i.e., <a href="#sec-causalDiagramConfounding">confounds</a> that do not change across time). However, predicting within-person change does not, by itself, control for time-varying <a href="#sec-causalDiagramConfounding">confounds</a>. So, it can also be useful to control for time-varying <a href="#sec-causalDiagramConfounding">confounds</a>, such as by use of <a href="#sec-causalInferenceControlVariables">control variables</a>.</p>
</section><section id="sec-causalInferenceControlVariables" class="level4" data-number="12.4.2.3"><h4 data-number="12.4.2.3" class="anchored" data-anchor-id="sec-causalInferenceControlVariables">
<span class="header-section-number">12.4.2.3</span> Control Variables</h4>
<p>One of the plausible alternatives to the inference that <code>X</code> causes <code>Y</code> is that there are third variable <a href="#sec-causalDiagramConfounding">confounds</a> that influence both <code>X</code> and <code>Y</code>, thus explaining why <code>X</code> and <code>Y</code> are associated, as depicted in Figures <a href="research-methods.html#fig-correlationAndCausation3" class="quarto-xref"><span>7.3</span></a> and <a href="#fig-ZCausesXandY" class="quarto-xref"><span>12.10</span></a>. Thus, another approach that can help increase <a href="research-methods.html#sec-internalValidity">internal validity</a> is to include plausible <a href="#sec-causalDiagramConfounding">confounds</a> as control variables. For instance, if a third variable such as education level might be a <a href="#sec-causalDiagramConfounding">confound</a> that influences both sports drink consumption and player performance, you could include education level as a <a href="multiple-regression.html#sec-covariates">covariate</a> in the model. Inclusion of a <a href="multiple-regression.html#sec-covariates">covariate</a> attempts to control for the variable by examining the association between the <a href="research-methods.html#sec-correlationalStudy">predictor variable</a> and the <a href="research-methods.html#sec-correlationalStudy">outcome variable</a> while holding the <a href="multiple-regression.html#sec-covariates">covariate</a> variables constant. For instance, such a model would examine whether, when accounting for education level, there is an association between sports drink consumption and player performance.</p>
<p>Failure to control for important third variables can lead to erroneous conclusions, as evidenced by the association depicted in <a href="#fig-simpsonParadox" class="quarto-xref">Figure&nbsp;<span>12.5</span></a>. In the example, if we did not control for gender, we would infer that there is a positive association between dosage and recovery probability. However, when we examine each men and women separately, we learn that the association between dosage and recovery probability is actually negative within each gender group. Thus, in this case, failure to control for gender would lead to false inferences about the association between dosage and recovery probability.</p>
<div id="fig-simpsonParadox" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-simpsonParadox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/simpsonParadox.png" class="img-fluid figure-img" style="width:200.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simpsonParadox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.5: Example Where Failing to Control for a Variable (In This Case, Gender) Would Lead to False Inferences. In this example, the association between dosage and recovery probability is positive at the population level, but the association is negative among men and women separately. (Figure reprinted from <span class="citation" data-cites="Kievit2013">Kievit et al. (<a href="references.html#ref-Kievit2013" role="doc-biblioref">2013</a>)</span>, Figure 1, p.&nbsp;2. Kievit, R., Frankenhuis, W., Waldorp, L., &amp; Borsboom, D. (2013). Simpson’s paradox in psychological science: a practical guide. <em>Frontiers in Psychology</em>, <em>4</em>(513). <a href="https://doi.org/10.3389/fpsyg.2013.00513">https://doi.org/10.3389/fpsyg.2013.00513</a>)
</figcaption></figure>
</div>
<p>However, it can be problematic to control for variables indiscriminantly. The use of <a href="#sec-causalDiagrams">causal diagrams</a> can inform which variables are important to be included as control variables, and—just as important—which variables not to include as control variables, as described in <a href="#sec-causalDiagrams" class="quarto-xref"><span>Section 12.5</span></a>.</p>
</section><section id="sec-causalInferenceGeneticallyInformed" class="level4" data-number="12.4.2.4"><h4 data-number="12.4.2.4" class="anchored" data-anchor-id="sec-causalInferenceGeneticallyInformed">
<span class="header-section-number">12.4.2.4</span> Genetically Informed Designs</h4>
<p>Another approach to control for variables is to use genetically informed designs. Genetically informed designs allow controlling for potential genetic effects in order to more closely approximate the contributions of various environmental effects. Genetically informed designs exploit differing degrees of genetic relatedness among participants to capture the extent to which genetic factors may contribute to an outcome. The average percent of DNA shared between people of varying relationships is provided in <a href="#tbl-geneticRelatednessRelativePairs" class="quarto-xref">Table&nbsp;<span>12.1</span></a> (<a href="https://isogg.org/wiki/Autosomal_DNA_statistics" class="uri">https://isogg.org/wiki/Autosomal_DNA_statistics</a>; archived at <a href="https://perma.cc/MK3D-DST8" class="uri">https://perma.cc/MK3D-DST8</a>):</p>
<div id="tbl-geneticRelatednessRelativePairs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-geneticRelatednessRelativePairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12.1: Average Percent of Autosomal DNA Shared by Pairs of Relatives by Relationship Type.
</figcaption><div aria-describedby="tbl-geneticRelatednessRelativePairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Relationship</th>
<th style="text-align: left;">Average Percent of Autosomal DNA Shared by Pairs of Relatives</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Monozygotic (“identical”) twins</td>
<td style="text-align: left;">100%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dizygotic (“fraternal”) twins</td>
<td style="text-align: left;">50%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Parent/child</td>
<td style="text-align: left;">50%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Full siblings</td>
<td style="text-align: left;">50%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Grandparent/grandchild</td>
<td style="text-align: left;">25%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aunt-or-uncle/niece-or-nephew</td>
<td style="text-align: left;">25%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Half-siblings</td>
<td style="text-align: left;">25%</td>
</tr>
<tr class="even">
<td style="text-align: left;">First cousin</td>
<td style="text-align: left;">12.5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Great-grandparent/great-grandchild</td>
<td style="text-align: left;">12.5%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>For instance, researchers may compare monozygotic twins versus dizygotic twins in some outcome—a so-called “twin study”. It is assumed that the trait/outcome is attributable to genetic factors to the extent that the monozygotic twins (who share 100% of their DNA) are more similar in the trait or outcome compared to the dizygotic twins (who share on average 50% of their DNA). Alternatively, researchers could compare full siblings versus half-siblings, or they could compare full siblings versus first cousins.</p>
<p>Genetically informed designs are not as relevant for fantasy football analytics, but they are useful to present as one of various design features that researchers can draw upon to strengthen their ability to make causal inferences.</p>
</section></section></section><section id="sec-causalDiagrams" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="sec-causalDiagrams">
<span class="header-section-number">12.5</span> Causal Diagrams</h2>
<section id="sec-causalDiagramsOverview" class="level3" data-number="12.5.1"><h3 data-number="12.5.1" class="anchored" data-anchor-id="sec-causalDiagramsOverview">
<span class="header-section-number">12.5.1</span> Overview</h3>
<p>A key tool when describing a research question or hypothesis is to create a conceptual depiction of the hypothesized causal processes. A causal diagram depicts the hypothesized causal processes that link two or more variables. A common form of causal diagrams is the directed acyclic graph (DAG). DAGs provide a helpful tool to communicate about causal questions and help identify how to avoid bias (i.e., overestimation) in associations between variables due to <a href="#sec-causalDiagramConfounding">confounding</a> (i.e., common causes) <span class="citation" data-cites="Digitale2022">(<a href="references.html#ref-Digitale2022" role="doc-biblioref">Digitale et al., 2022</a>)</span>. For instance, from a DAG, it is possible to determine what variables it is important to control for in order to get unbiased estimates of the association between two variables of interest. To create DAGs, you can use the <code>R</code> package <code>dagitty</code> <span class="citation" data-cites="Textor2017">(<a href="references.html#ref-Textor2017" role="doc-biblioref">Textor et al., 2017</a>)</span> or the associated browser-based extension, DAGitty: <a href="https://dagitty.net" class="uri">https://dagitty.net</a> (archived at <a href="https://perma.cc/U9BY-VZE2" class="uri">https://perma.cc/U9BY-VZE2</a>). Examples of various causal diagrams that could explain why <code>X</code> is associated with <code>Y</code> are in Figures <a href="#fig-XCausesY" class="quarto-xref"><span>12.6</span></a>, <a href="#fig-YCausesX" class="quarto-xref"><span>12.8</span></a> and <a href="#fig-ZCausesXandY" class="quarto-xref"><span>12.10</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>XCausesY <span class="ot">&lt;-</span> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">"dag{</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  X -&gt; Y</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">}"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">plot</span>(dagitty<span class="sc">::</span><span class="fu">graphLayout</span>(XCausesY))</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(XCausesY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-XCausesY" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-XCausesY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-XCausesY-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-XCausesY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.6: Causal Diagram (Directed Acyclic Graph) Depicting <code>X</code> Causing <code>Y</code>.
</figcaption></figure>
</div>
</div>
</div>
<p>Here is an alternative way of specifying the same diagram (more similar to <code>lavaan</code> syntax):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>XCausesY_alt <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  Y <span class="sc">~</span> X</span>
<span id="cb3-3"><a href="#cb3-3"></a>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#plot(XCausesY_alt) # this creates the same plot as above</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>ggdag<span class="sc">::</span><span class="fu">ggdag</span>(XCausesY_alt) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-XCausesY2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-XCausesY2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-XCausesY2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-XCausesY2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.7: Causal Diagram (Directed Acyclic Graph) Depicting <code>X</code> Causing <code>Y</code>.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>YCausesX <span class="ot">&lt;-</span> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">"dag{</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  Y -&gt; X</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">}"</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="fu">plot</span>(dagitty<span class="sc">::</span><span class="fu">graphLayout</span>(YCausesX))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(YCausesX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-YCausesX" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-YCausesX-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-YCausesX-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-YCausesX-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.8: Causal Diagram (Directed Acyclic Graph) Depicting Reverse Causation: <code>Y</code> Causing <code>X</code>.
</figcaption></figure>
</div>
</div>
</div>
<p>Here is an alternative way of specifying the same diagram (more similar to <code>lavaan</code> syntax):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>YCausesX_alt <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  X <span class="sc">~</span> Y</span>
<span id="cb5-3"><a href="#cb5-3"></a>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#plot(YCausesX_alt) # this creates the same plot as above</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>ggdag<span class="sc">::</span><span class="fu">ggdag</span>(YCausesX_alt) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-YCausesX2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-YCausesX2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-YCausesX2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-YCausesX2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.9: Causal Diagram (Directed Acyclic Graph) Depicting Reverse Causation: <code>Y</code> Causing <code>X</code>.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ZCausesXandY <span class="ot">&lt;-</span> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">"dag{</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  Z -&gt; Y</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  Z -&gt; X</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  X &lt;-&gt; Y</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">}"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="fu">plot</span>(dagitty<span class="sc">::</span><span class="fu">graphLayout</span>(ZCausesXandY))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-ZCausesXandY" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ZCausesXandY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-ZCausesXandY-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ZCausesXandY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.10: Causal Diagram (Directed Acyclic Graph) Depicting a Third Variable Confound, <code>Z</code>, Causing <code>X</code> and <code>Y</code>, Thus Explaining Why <code>X</code> and <code>Y</code> are associated.
</figcaption></figure>
</div>
</div>
</div>
<p>Here is an alternative way of specifying the same diagram (more similar to <code>lavaan</code> syntax):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>ZCausesXandY_alt <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  X <span class="sc">~</span> Z,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  Y <span class="sc">~</span> Z,</span>
<span id="cb7-4"><a href="#cb7-4"></a>  X <span class="sc">~</span><span class="er">~</span> Y</span>
<span id="cb7-5"><a href="#cb7-5"></a>)</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#plot(ZCausesXandY_alt) # this creates the same plot as above</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>ggdag<span class="sc">::</span><span class="fu">ggdag</span>(ZCausesXandY_alt) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-ZCausesXandY2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ZCausesXandY2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-ZCausesXandY2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ZCausesXandY2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.11: Causal Diagram (Directed Acyclic Graph) Depicting a Third Variable Confound, <code>Z</code>, Causing <code>X</code> and <code>Y</code>, Thus Explaining Why <code>X</code> and <code>Y</code> are associated.
</figcaption></figure>
</div>
</div>
</div>
<p>Consider another example in <a href="#fig-dag" class="quarto-xref">Figure&nbsp;<span>12.12</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>mediationDag <span class="ot">&lt;-</span> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">"dag{</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  X -&gt; M1</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  X -&gt; M2</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  M1 -&gt; Y</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="st">  M2 -&gt; Y</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="st">  M1 &lt;-&gt; M2</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">}"</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="fu">plot</span>(dagitty<span class="sc">::</span><span class="fu">graphLayout</span>(mediationDag))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-dag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-dag-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.12: Causal Diagram (Directed Acyclic Graph).
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(mediationDag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>X _||_ Y | M1, M2</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb11-2"><a href="#cb11-2"></a>  mediationDag, </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="at">exposure =</span> <span class="st">"M1"</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ M2 }</code></pre>
</div>
</div>
<p>In this example, <code>X</code> influences <code>Y</code> via <code>M1</code> and <code>M2</code> (i.e., multiple mediators), and <code>M1</code> is also associated with <code>M2</code>. The <code><a href="https://rdrr.io/pkg/dagitty/man/impliedConditionalIndependencies.html">dagitty::impliedConditionalIndependencies()</a></code> function identifies variables in the causal diagram that are conditionally independent (i.e., uncorrelated) after controlling for other variables in the model. For this causal diagram, <code>X</code> is conditionally independent with <code>Y</code> because <code>X</code> is independent with <code>Y</code> when controlling for <code>M1</code> and <code>M2</code>.</p>
<p>The <code><a href="https://rdrr.io/pkg/dagitty/man/adjustmentSets.html">dagitty::adjustmentSets()</a></code> function identifies variables that would be necessary to control for (i.e., to include as covariates) in order to identify an unbiased estimate of the association (whether the total effect, i.e., <code>effect = "total"</code>; or the direct effect, i.e., <code>effect = "direct"</code>) between two variables (<code>exposure</code> and <code>outcome</code>). In this case, to identify the unbiased association between <code>M1</code> and <code>Y</code>, it is important to control for <code>M2.</code></p>
<p>Here is an alternative way of specifying the same diagram (more similar to <code>lavaan</code> syntax):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>mediationDag_alt <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">dagify</span>(</span>
<span id="cb13-2"><a href="#cb13-2"></a>  M1 <span class="sc">~</span> X,</span>
<span id="cb13-3"><a href="#cb13-3"></a>  M2 <span class="sc">~</span> X,</span>
<span id="cb13-4"><a href="#cb13-4"></a>  Y <span class="sc">~</span> M1,</span>
<span id="cb13-5"><a href="#cb13-5"></a>  Y <span class="sc">~</span> M2,</span>
<span id="cb13-6"><a href="#cb13-6"></a>  M1 <span class="sc">~</span><span class="er">~</span> M2</span>
<span id="cb13-7"><a href="#cb13-7"></a>)</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#plot(mediationDag_alt) # this creates the same plot as above</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>ggdag<span class="sc">::</span><span class="fu">ggdag</span>(mediationDag_alt) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-dag2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dag2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-dag2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.13: Causal Diagram (Directed Acyclic Graph).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-causalDiagramConfounding" class="level3" data-number="12.5.2"><h3 data-number="12.5.2" class="anchored" data-anchor-id="sec-causalDiagramConfounding">
<span class="header-section-number">12.5.2</span> Confounding</h3>
<p>Confounding occurs when two variables—that are both caused by another variable(s)—have a spurious or noncausal association <span class="citation" data-cites="DOnofrio2020">(<a href="references.html#ref-DOnofrio2020" role="doc-biblioref">D’Onofrio et al., 2020</a>)</span>. That is, two variables share a common cause, and the common cause leads the variables to be associated even though they are not causally related. The common cause—i.e., the variable that influences the two variables—is known as a confound (or confounder). An example of confounding is depicted in <a href="#fig-counfounding" class="quarto-xref">Figure&nbsp;<span>12.14</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>confounding <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">confounder_triangle</span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="at">x =</span> <span class="st">"Player Endurance"</span>,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="at">y =</span> <span class="st">"Field Goals Made"</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="at">z =</span> <span class="st">"Stadium Altitude"</span>) </span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>confounding <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb14-8"><a href="#cb14-8"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-counfounding" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-counfounding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-counfounding-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-counfounding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.14: Causal Diagram (Directed Acyclic Graph) Example of Confounding.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(confounding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>x _||_ y | z</code></pre>
</div>
</div>
<p>The output indicates that player endurance (<code>X</code>) and field goals made (<code>Y</code>) are conditionally independent when accounting for stadium altitude (<code>Z</code>). <em>Conditional independence</em> refers to two variables being unassociated when controlling for other variables.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  confounding, </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ z }</code></pre>
</div>
</div>
<p>The output indicates that, to obtain an unbiased estimate of the causal association between two variables, it is necessary to control for any confounding <span class="citation" data-cites="Lederer2019">(<a href="references.html#ref-Lederer2019" role="doc-biblioref">Lederer et al., 2019</a>)</span>. That is, to obtain an unbiased estimate of the causal association between player endurance (<code>X</code>) and field goals made (<code>Y</code>), it is necessary to control for stadium altitude (<code>Z</code>).</p>
</section><section id="sec-causalDiagramMediation" class="level3" data-number="12.5.3"><h3 data-number="12.5.3" class="anchored" data-anchor-id="sec-causalDiagramMediation">
<span class="header-section-number">12.5.3</span> Mediation</h3>
<p>Mediation can be divided into two types: <a href="#sec-causalDiagramMediationFull">full</a> and <a href="#sec-causalDiagramMediationPartial">partial</a>. In <a href="#sec-causalDiagramMediationFull">full mediation</a>, the mediator(s) fully account for the effect of the predictor variable on the outcome variable. In <a href="#sec-causalDiagramMediationPartial">partial mediation</a>, the mediator(s) partially but do not fully account for the effect of the <a href="research-methods.html#sec-correlationalStudy">predictor variable</a> on the <a href="research-methods.html#sec-correlationalStudy">outcome variable</a>.</p>
<section id="sec-causalDiagramMediationFull" class="level4" data-number="12.5.3.1"><h4 data-number="12.5.3.1" class="anchored" data-anchor-id="sec-causalDiagramMediationFull">
<span class="header-section-number">12.5.3.1</span> Full Mediation</h4>
<p>An example of full mediation is depicted in <a href="#fig-fullMediation" class="quarto-xref">Figure&nbsp;<span>12.15</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>full_mediation <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">mediation_triangle</span>(</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="at">x =</span> <span class="st">"Coaching Quality"</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="at">y =</span> <span class="st">"Fantasy Points"</span>,</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="at">m =</span> <span class="st">"Player Preparation"</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a>full_mediation <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-fullMediation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-fullMediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-fullMediation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fullMediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.15: Causal Diagram (Directed Acyclic Graph) Example of Full Mediation.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(full_mediation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>x _||_ y | m</code></pre>
</div>
</div>
<p>In full mediation, <code>X</code> and <code>Y</code> are conditionally independent when accounting for the mediator (<code>Z</code>). In this case, coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) are conditionally independent when accounting for player preparation (<code>M</code>). In other words, in this example, player preparation is the mechanism that fully (i.e., 100%) accounts for the effect of coaching quality on players’ fantasy points.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb22-2"><a href="#cb22-2"></a>  full_mediation, </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="at">effect =</span> <span class="st">"direct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ m }</code></pre>
</div>
</div>
<p>The output indicates that, to obtain an unbiased estimate of the <em>direct</em> causal association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) (i.e., the effect that is <em>not</em> mediated through intermediate processes), it is necessary to control for player preparation (<code>M</code>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb24-2"><a href="#cb24-2"></a>  full_mediation, </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>However, to obtain an unbiased estimate of the <em>total</em> causal association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) (i.e., including the portion of the effect that is mediated through intermediate processes), it is important <em>not</em> to control for player preparation (<code>M</code>). When the goal is to understand the (total) causal effect of coaching quality (<code>X</code>) and fantasy points (<code>Y</code>), controlling for the mediator (player preparation; <code>M</code>) would be inappropriate because doing so would remove the causal effect, thus artificially reducing the estimate of the association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) <span class="citation" data-cites="Lederer2019">(<a href="references.html#ref-Lederer2019" role="doc-biblioref">Lederer et al., 2019</a>)</span>.</p>
</section><section id="sec-causalDiagramMediationPartial" class="level4" data-number="12.5.3.2"><h4 data-number="12.5.3.2" class="anchored" data-anchor-id="sec-causalDiagramMediationPartial">
<span class="header-section-number">12.5.3.2</span> Partial Mediation</h4>
<p>An example of partial mediation is depicted in <a href="#fig-partialMediation" class="quarto-xref">Figure&nbsp;<span>12.16</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>partial_mediation <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">mediation_triangle</span>(</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="at">x =</span> <span class="st">"Coaching Quality"</span>,</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="at">y =</span> <span class="st">"Fantasy Points"</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="at">m =</span> <span class="st">"Player Preparation"</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="at">x_y_associated =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a>partial_mediation <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb26-9"><a href="#cb26-9"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-10"><a href="#cb26-10"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-partialMediation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-partialMediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-partialMediation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-partialMediation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.16: Causal Diagram (Directed Acyclic Graph) Example of Partial Mediation.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(partial_mediation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In partial mediation, <code>X</code> and <code>Y</code> are <em>not</em> conditionally independent when accounting for the mediator (<code>Z</code>). In this case, coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) are still associated when accounting for player preparation (<code>M</code>). In other words, in this example, player preparation is a mechanism that partially but does not fully account for the effect of coaching quality on players’ fantasy points. That is, there are likely other mechanisms, in addition to player preparation, that collectively account for the effect of coaching quality on fantasy points. For instance, coaching quality could also influence player fantasy points through better play-calling.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb28-2"><a href="#cb28-2"></a>  partial_mediation, </span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="at">effect =</span> <span class="st">"direct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ m }</code></pre>
</div>
</div>
<p>As with <a href="#sec-causalDiagramMediationPartial">full mediation</a>, the output indicates that, to obtain an unbiased estimate of the <em>direct</em> causal association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) (i.e., the effect that is <em>not</em> mediated through intermediate processes), it is necessary to control for player preparation (<code>M</code>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb30-2"><a href="#cb30-2"></a>  partial_mediation, </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>However, as with <a href="#sec-causalDiagramMediationPartial">full mediation</a>, to obtain an unbiased estimate of the <em>total</em> causal association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) (i.e., including the portion of the effect that is mediated through intermediate processes), it is important <em>not</em> to control for player preparation (<code>M</code>). When the goal is to understand the (total) causal effect of coaching quality (<code>X</code>) and fantasy points (<code>Y</code>), controlling for a mediator (player preparation; <code>M</code>) would be inappropriate because doing so would remove the causal effect, thus artificially reducing the estimate of the association between coaching quality (<code>X</code>) and fantasy points (<code>Y</code>) <span class="citation" data-cites="Lederer2019">(<a href="references.html#ref-Lederer2019" role="doc-biblioref">Lederer et al., 2019</a>)</span>.</p>
</section></section><section id="sec-ancestorsDescendants" class="level3" data-number="12.5.4"><h3 data-number="12.5.4" class="anchored" data-anchor-id="sec-ancestorsDescendants">
<span class="header-section-number">12.5.4</span> Ancestors and Descendants</h3>
<p>In a causal model, an <em>ancestor</em> is a variable that influences another variable, either directly or indirectly via another variable <span class="citation" data-cites="Rohrer2018">(<a href="references.html#ref-Rohrer2018" role="doc-biblioref">Rohrer, 2018</a>)</span>. A <em>descendant</em> is a variable that is influenced by another variable <span class="citation" data-cites="Rohrer2018">(<a href="references.html#ref-Rohrer2018" role="doc-biblioref">Rohrer, 2018</a>)</span>. In general, one should not control for descendants of the outcome variable, because doing so could eliminate the apparent effect of a legitimate cause on the outcome variable <span class="citation" data-cites="Digitale2022">(<a href="references.html#ref-Digitale2022" role="doc-biblioref">Digitale et al., 2022</a>)</span>. Moreover, as described above, when trying to understand the total causal effect of a predictor variable on an outcome variable, one should not control for descendants of the predictor variable that are also antecedents of the outcome variable (i.e., mediators of the effect of the predictor variable on the outcome variable) <span class="citation" data-cites="Digitale2022">(<a href="references.html#ref-Digitale2022" role="doc-biblioref">Digitale et al., 2022</a>)</span>.</p>
<p>Consider the example in <a href="#fig-dagDescendant" class="quarto-xref">Figure&nbsp;<span>12.17</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>descendentDag <span class="ot">&lt;-</span> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">"dag{</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  X -&gt; M</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  M -&gt; Y</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">  X -&gt; Y</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">  Y -&gt; Z</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">}"</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="co">#plot(dagitty::graphLayout(descendentDag))</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>ggdag<span class="sc">::</span><span class="fu">ggdag</span>(descendentDag) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-dagDescendant" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dagDescendant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-dagDescendant-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dagDescendant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.17: Causal Diagram (Directed Acyclic Graph) Example of Ancestor (Mediation) and Descendant of Y.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(descendentDag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>M _||_ Z | Y
X _||_ Z | Y</code></pre>
</div>
</div>
<p>In this example, <code>X</code> and <code>M</code> are conditionally independent with <code>Z</code> when accounting for the mediator (<code>Y</code>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb35-2"><a href="#cb35-2"></a>  descendentDag, </span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span>,</span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="at">effect =</span> <span class="st">"direct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ M }</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb37-2"><a href="#cb37-2"></a>  descendentDag, </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="at">exposure =</span> <span class="st">"X"</span>,</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="at">outcome =</span> <span class="st">"Y"</span>,</span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>As indicated above, one should not control for the descendant of the outcome variable; thus, one should not control for <code>Z</code> when examining the association between <code>X</code> or <code>M</code> and <code>Y</code>.</p>
</section><section id="sec-colliderBias" class="level3" data-number="12.5.5"><h3 data-number="12.5.5" class="anchored" data-anchor-id="sec-colliderBias">
<span class="header-section-number">12.5.5</span> Collider Bias</h3>
<p><em>Collision</em> occurs when two variables influence a third variable, the collider <span class="citation" data-cites="DOnofrio2020">(<a href="references.html#ref-DOnofrio2020" role="doc-biblioref">D’Onofrio et al., 2020</a>)</span>. That is, a collider is a variable that is caused by two other variables (i.e., a common effect). An example collision is depicted in Figures <a href="#fig-colliderBias1" class="quarto-xref"><span>12.18</span></a> and <a href="#fig-colliderBias2" class="quarto-xref"><span>12.19</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>colliderBias1 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">collider_triangle</span>(</span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="at">x =</span> <span class="st">"Diet"</span>,</span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="at">y =</span> <span class="st">"Coaching Strategy"</span>,</span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="at">m =</span> <span class="st">"Injury Status"</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a></span>
<span id="cb39-6"><a href="#cb39-6"></a>colliderBias1 <span class="sc">%&gt;%</span> </span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-9"><a href="#cb39-9"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-colliderBias1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-colliderBias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-colliderBias1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-colliderBias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.18: Causal Diagram (Directed Acyclic Graph) Example of a Collision with a Collider (Injury Status).
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(colliderBias1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>x _||_ y</code></pre>
</div>
</div>
<p>In this example collision, diet (<code>X</code>) and coaching strategy (<code>Y</code>) are independent.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb42-2"><a href="#cb42-2"></a>  colliderBias1, </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>As the output indicates, we should not control for the collider when examining the association between the two causes of the collider. That is, we should not control for injury status (<code>M</code>) when examining the association between diet (<code>X</code>) and coaching strategy. Controlling for the collider leads to confounding and can artificially induce an association between the two causes of the collider despite no causal association between them <span class="citation" data-cites="Lederer2019">(<a href="references.html#ref-Lederer2019" role="doc-biblioref">Lederer et al., 2019</a>)</span>. Obtaining a distorted or artificial association between two variables due to inappropriately controlling for a collider is known as <em>collider bias</em>.</p>
<p>Consider another example:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>colliderBias2 <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">collider_triangle</span>(</span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="at">x =</span> <span class="st">"Coaching Quality"</span>,</span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="at">y =</span> <span class="st">"Player Preparation"</span>,</span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="at">m =</span> <span class="st">"Fantasy Points"</span>,</span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="at">x_y_associated =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a>colliderBias2 <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-10"><a href="#cb44-10"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-colliderBias2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-colliderBias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-colliderBias2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-colliderBias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.19: Causal Diagram (Directed Acyclic Graph) Example of Collider Bias.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(colliderBias2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In this example of collider bias, there are no conditional independencies.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  colliderBias2, </span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>Again, it would be important not to control for the collider, fantasy points (<code>M</code>), when examining the association between coaching quality (<code>X</code>) and player preparation (<code>Y</code>). In this case, controlling for the collider would remove some of the causal effect of coaching quality on player preparation and could lead to an artificially smaller estimate of the causal effect between coaching quality and player preparation.</p>
<section id="sec-causalDiagramMBias" class="level4" data-number="12.5.5.1"><h4 data-number="12.5.5.1" class="anchored" data-anchor-id="sec-causalDiagramMBias">
<span class="header-section-number">12.5.5.1</span> M-Bias</h4>
<p><a href="#sec-colliderBias">Collider bias</a> may also occur when neither variable of interest is a direct cause of the <a href="#sec-colliderBias">collider</a> <span class="citation" data-cites="Lederer2019">(<a href="references.html#ref-Lederer2019" role="doc-biblioref">Lederer et al., 2019</a>)</span>. M-bias is a form of <a href="#sec-colliderBias">collider bias</a> that occurs when two variables that are not causally related, <code>A</code> and <code>B</code>, both influence a <a href="#sec-colliderBias">collider</a>, <code>M</code>, and each (<code>A</code> and <code>B</code>) also influences a separate variable—e.g., <code>A</code> influences <code>X</code> and <code>B</code> influences <code>Y</code>. M-bias is so-named from the M-shape of the DAG. An example of M-bias is depicted in <a href="#fig-mBias" class="quarto-xref">Figure&nbsp;<span>12.20</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>mBias <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">m_bias</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="at">x =</span> <span class="st">"Number of Media Articles About the Team"</span>,</span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="at">y =</span> <span class="st">"Fantasy Points"</span>,</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="at">a =</span> <span class="st">"Team Record"</span>,</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="at">b =</span> <span class="st">"Coaching Quality"</span>,</span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="at">m =</span> <span class="st">"Fan Attendance at Game"</span>)</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>mBias <span class="sc">%&gt;%</span> </span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb48-10"><a href="#cb48-10"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-11"><a href="#cb48-11"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb48-12"><a href="#cb48-12"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-mBias" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-mBias-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.20: Causal Diagram (Directed Acyclic Graph) Example of M-Bias.
</figcaption></figure>
</div>
</div>
</div>
<p>In this example, fan attendance is the <a href="#sec-colliderBias">collider</a> that is influenced separately by the team record and the coaching quality. This is a fictitious example for purposes of demonstration; in reality, coaching quality influences the team’s record.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(mBias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>a _||_ b
a _||_ y
b _||_ x
m _||_ x | a
m _||_ y | b
x _||_ y</code></pre>
</div>
</div>
<p>As the output indicates, there are several conditional independencies.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb51-2"><a href="#cb51-2"></a>  mBias, </span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html"> {}</a></code></pre>
</div>
</div>
<p>It is important not to control for the <a href="#sec-colliderBias">collider</a> (fan attendance). If you control for the <a href="#sec-colliderBias">collider</a>, you can induce an artificial association between team record and coaching quality. Moreover, because doing so induces an artificial association between team record and coaching quality, it can also induce an artificial association between the effects of team record and coaching quality: number of media articles about the team and fantasy points, respectively. That is, controlling for the <a href="#sec-colliderBias">collider</a> can lead to an artificial association between <code>X</code> and <code>Y</code> that does not reflect a causal process.</p>
</section><section id="sec-butterflyBias" class="level4" data-number="12.5.5.2"><h4 data-number="12.5.5.2" class="anchored" data-anchor-id="sec-butterflyBias">
<span class="header-section-number">12.5.5.2</span> Butterfly Bias</h4>
<p>Butterfly bias occurs when both <a href="#sec-causalDiagramConfounding">confounding</a> and <a href="#sec-causalDiagramMBias">M-bias</a> are present. Butterfly bias (aka bow-tie bias) is so-named from the butterfly shape of the DAG. In butterfly bias, the following criteria are met:</p>
<ul>
<li>Two variables (<code>A</code> and <code>B</code>) influence a <a href="#sec-colliderBias">collider</a> (<code>M</code>).</li>
<li>The <a href="#sec-colliderBias">collider</a> influences two variables, <code>X</code> and <code>Y</code>.</li>
<li>
<code>A</code> also influences <code>X</code>.</li>
<li>
<code>B</code> also influences <code>Y</code>.</li>
<li>
<code>A</code> and <code>B</code> are not causally related.</li>
<li>
<code>X</code> and <code>Y</code> are not causally related.</li>
</ul>
<p>Or, more succinctly:</p>
<ul>
<li>
<code>A</code> influences <code>M</code> and <code>X</code>.</li>
<li>
<code>B</code> influences <code>M</code> and <code>Y</code>.</li>
<li>
<code>M</code> influences <code>X</code> and <code>Y</code>.</li>
</ul>
<p>In butterfly bias, the <a href="#sec-colliderBias">collider</a> (<code>M</code>) is also a <a href="#sec-causalDiagramConfounding">confound</a>. That is, a variable is both influenced by two variables and influences two variables. An example of butterfly bias is depicted in <a href="#fig-butterflyBias" class="quarto-xref">Figure&nbsp;<span>12.21</span></a>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>butterflyBias <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">butterfly_bias</span>(</span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="at">x =</span> <span class="st">"Off-field Behavior"</span>,</span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="at">y =</span> <span class="st">"Fantasy Points"</span>,</span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="at">a =</span> <span class="st">"Diet"</span>,</span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="at">b =</span> <span class="st">"Coaching Quality"</span>,</span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="at">m =</span> <span class="st">"Mental Health"</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a></span>
<span id="cb53-8"><a href="#cb53-8"></a>butterflyBias <span class="sc">%&gt;%</span> </span>
<span id="cb53-9"><a href="#cb53-9"></a>  <span class="fu">ggdag</span>(</span>
<span id="cb53-10"><a href="#cb53-10"></a>    <span class="at">text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-11"><a href="#cb53-11"></a>    <span class="at">use_labels =</span> <span class="st">"label"</span>) <span class="sc">+</span> </span>
<span id="cb53-12"><a href="#cb53-12"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-butterflyBias" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-butterflyBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causal-inference_files/figure-html/fig-butterflyBias-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-butterflyBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.21: Causal Diagram (Directed Acyclic Graph) Example of Butterfly Bias.
</figcaption></figure>
</div>
</div>
</div>
<p>In this case, players’ mental health is a <a href="#sec-colliderBias">collider</a> of their diet and the quality of the coaching they receive. In addition, players’ mental health is a <a href="#sec-causalDiagramConfounding">confound</a> of their off-field behavior and fantasy points.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>dagitty<span class="sc">::</span><span class="fu">impliedConditionalIndependencies</span>(butterflyBias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>a _||_ b
a _||_ y | b, m
b _||_ x | a, m
x _||_ y | b, m
x _||_ y | a, m</code></pre>
</div>
</div>
<p>As the output indicates, there are several conditional independencies.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(</span>
<span id="cb56-2"><a href="#cb56-2"></a>  butterflyBias, </span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="at">exposure =</span> <span class="st">"x"</span>,</span>
<span id="cb56-4"><a href="#cb56-4"></a>  <span class="at">outcome =</span> <span class="st">"y"</span>,</span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>{ b, m }
{ a, m }</code></pre>
</div>
</div>
<p>When dealing with a <a href="#sec-colliderBias">collider</a> that is also a <a href="#sec-causalDiagramConfounding">confound</a>, controlling for either set, <code>B</code> and <code>M</code> or <code>A</code> and <code>M</code>, will provide an unbiased estimate of the association between <code>X</code> and <code>Y</code>. In this case, controlling for either a) coaching quality and mental health or b) diet and mental health—but not both sets—will yield an unbiased estimate of the association between off-field behavior and fantasy points.</p>
</section></section><section id="sec-causalDiagramSelectionBias" class="level3" data-number="12.5.6"><h3 data-number="12.5.6" class="anchored" data-anchor-id="sec-causalDiagramSelectionBias">
<span class="header-section-number">12.5.6</span> Selection Bias</h3>
<p>Selection bias occurs when the selection of participants or their inclusion in analyses depends on the variables being studied. For instance, if you are conducting a study on the extent to which sports drink consumption influences fantasy points, there would be selection bias if players are less likely to participate in the study if they score fewer fantasy points.</p>
<p>Now, consider a study in which you conduct a randomized controlled trial (RCT; i.e., an <a href="research-methods.html#sec-experiment">experiment</a>) to evaluate the effect of a new medication on player performance. You randomly assign some players to take the medication and other players to take a placebo. Assume the new medication has side effects and leads many of the players who take it to drop out of the study. This is an example of attrition bias (i.e., systematic attrition). If you were to exclude these individuals from your analysis, it may make it appear that the medication led to better performance, because the players who experienced the side effect (and worse performance) dropped out of the study. Hence, conducting an analysis that excludes these players from the analysis would involve selection bias.</p>
</section></section><section id="sec-causalInferenceConclusion" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="sec-causalInferenceConclusion">
<span class="header-section-number">12.6</span> Conclusion</h2>
<p>There are three criteria for establishing causality: 1) the cause precedes the effect. 2) The cause is related to the effect. 3) There are no other alternative explanations for the effect apart from the cause. In general, it is important to be aware of the counterfactual and to consider what would have happened if the supposed cause had not occurred. Various experimental and quasi-experimental designs and approaches can be leveraged to more closely approximate causal inferences. <a href="#sec-causalInferenceLongitudinal">Longitudinal designs</a>, <a href="#sec-causalInferenceWithinSubject">within-subject analyses</a>, <a href="#sec-causalInferenceControlVariables">inclusion of control variables</a>, and <a href="#sec-causalInferenceGeneticallyInformed">genetically informed designs</a> are all quasi-experimental designs that afford the researcher greater control over some possible third variable <a href="#sec-causalDiagramConfounding">confounds</a>. Causal diagrams can be a useful tool for identifying the proper variables to control for (and those not to control for). When <a href="#sec-causalDiagramConfounding">confounding</a> exists, it is important to control for the <a href="#sec-causalDiagramConfounding">confound(s)</a>. It is important not to control for mediators when interested in the total effect of the <a href="research-methods.html#sec-correlationalStudy">predictor variable</a> on the <a href="research-methods.html#sec-correlationalStudy">outcome variable</a>. In addition, it is important not to control for <a href="#sec-ancestorsDescendants">descendants</a> of the <a href="research-methods.html#sec-correlationalStudy">outcome variable</a>. When there is a <a href="#sec-colliderBias">collision</a>, it is important not to control for the <a href="#sec-colliderBias">collider</a> (unless the <a href="#sec-colliderBias">collider</a> is also a <a href="#sec-causalDiagramConfounding">confound</a>).</p>
</section><section id="sec-causalInferenceSessionInfo" class="level2" data-number="12.7"><h2 data-number="12.7" class="anchored" data-anchor-id="sec-causalInferenceSessionInfo">
<span class="header-section-number">12.7</span> Session Info</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggdag_0.2.13  dagitty_0.3-4

loaded via a namespace (and not attached):
 [1] viridis_0.6.5      utf8_1.2.4         generics_0.1.3     tidyr_1.3.1       
 [5] stringi_1.8.4      digest_0.6.36      magrittr_2.0.3     evaluate_0.24.0   
 [9] grid_4.4.1         fastmap_1.2.0      jsonlite_1.8.8     ggrepel_0.9.5     
[13] gridExtra_2.3      purrr_1.0.2        fansi_1.0.6        viridisLite_0.4.2 
[17] scales_1.3.0       tweenr_2.0.3       cli_3.6.3          rlang_1.1.4       
[21] graphlayouts_1.1.1 polyclip_1.10-7    tidygraph_1.3.1    munsell_0.5.1     
[25] withr_3.0.1        cachem_1.1.0       yaml_2.3.10        tools_4.4.1       
[29] memoise_2.0.1      dplyr_1.1.4        colorspace_2.1-1   ggplot2_3.5.1     
[33] boot_1.3-30        curl_5.2.1         vctrs_0.6.5        R6_2.5.1          
[37] lifecycle_1.0.4    stringr_1.5.1      V8_4.4.2           htmlwidgets_1.6.4 
[41] MASS_7.3-60.2      ggraph_2.2.1       pkgconfig_2.0.3    pillar_1.9.0      
[45] gtable_0.3.5       glue_1.7.0         Rcpp_1.0.13        ggforce_0.4.2     
[49] xfun_0.46          tibble_3.2.1       tidyselect_1.2.1   knitr_1.48        
[53] farver_2.1.2       htmltools_0.5.8.1  igraph_2.0.3       labeling_0.4.3    
[57] rmarkdown_2.27     compiler_4.4.1    </code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Corston2000" class="csl-entry" role="listitem">
Corston, R., &amp; Colman, A. M. (2000). <em>A crash course in SPSS for windows</em>. Wiley-Blackwell.
</div>
<div id="ref-DOnofrio2020" class="csl-entry" role="listitem">
D’Onofrio, B. M., Sjölander, A., Lahey, B. B., Lichtenstein, P., &amp; Öberg, A. S. (2020). Accounting for confounding in observational studies. <em>Annual Review of Clinical Psychology</em>, <em>16</em>(1), 25–48. <a href="https://doi.org/10.1146/annurev-clinpsy-032816-045030">https://doi.org/10.1146/annurev-clinpsy-032816-045030</a>
</div>
<div id="ref-Digitale2022" class="csl-entry" role="listitem">
Digitale, J. C., Martin, J. N., &amp; Glymour, M. M. (2022). Tutorial on directed acyclic graphs. <em>Journal of Clinical Epidemiology</em>, <em>142</em>, 264–267. <a href="https://doi.org/10.1016/j.jclinepi.2021.08.001">https://doi.org/10.1016/j.jclinepi.2021.08.001</a>
</div>
<div id="ref-Kievit2013" class="csl-entry" role="listitem">
Kievit, R., Frankenhuis, W., Waldorp, L., &amp; Borsboom, D. (2013). Simpson’s paradox in psychological science: A practical guide. <em>Frontiers in Psychology</em>, <em>4</em>(513). <a href="https://doi.org/10.3389/fpsyg.2013.00513">https://doi.org/10.3389/fpsyg.2013.00513</a>
</div>
<div id="ref-Lederer2019" class="csl-entry" role="listitem">
Lederer, D. J., Bell, S. C., Branson, R. D., Chalmers, J. D., Marshall, R., Maslove, D. M., Ost, D. E., Punjabi, N. M., Schatz, M., Smyth, A. R., Stewart, P. W., Suissa, S., Adjei, A. A., Akdis, C. A., Azoulay, É., Bakker, J., Ballas, Z. K., Bardin, P. G., Barreiro, E., … Vincent, J.-L. (2019). Control of confounding and reporting of results in causal inference studies. Guidance for authors from editors of respiratory, sleep, and critical care journals. <em>Annals of the American Thoracic Society</em>, <em>16</em>(1), 22–28. <a href="https://doi.org/10.1513/AnnalsATS.201808-564PS">https://doi.org/10.1513/AnnalsATS.201808-564PS</a>
</div>
<div id="ref-PetersenPrinciplesPsychAssessment" class="csl-entry" role="listitem">
Petersen, I. T. (2024b). <em>Principles of psychological assessment: With applied examples in <span>R</span></em>. University of Iowa Libraries. <a href="https://doi.org/10.25820/work.007199">https://doi.org/10.25820/work.007199</a>
</div>
<div id="ref-Petersen2024a" class="csl-entry" role="listitem">
Petersen, I. T. (2024a). <em>Principles of psychological assessment: With applied examples in <span>R</span></em>. <span>Chapman and Hall/CRC</span>. <a href="https://doi.org/10.1201/9781003357421">https://doi.org/10.1201/9781003357421</a>
</div>
<div id="ref-Rohrer2018" class="csl-entry" role="listitem">
Rohrer, J. M. (2018). Thinking clearly about correlations and causation: <span>G</span>raphical causal models for observational data. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>(1), 27–42. <a href="https://doi.org/10.1177/2515245917745629">https://doi.org/10.1177/2515245917745629</a>
</div>
<div id="ref-Shadish2002" class="csl-entry" role="listitem">
Shadish, W. R., Cook, T. D., &amp; Campbell, D. T. (2002). <em>Experimental and quasi-experimental designs for generalized causal inference</em>. Houghton Mifflin.
</div>
<div id="ref-Textor2017" class="csl-entry" role="listitem">
Textor, J., Zander, B. van der, Gilthorpe, M. S., Liśkiewicz, M., &amp; Ellison, G. T. (2017). Robust causal inference using directed acyclic graphs: The <span>R</span> package <span><span>“dagitty”</span></span>. <em>International Journal of Epidemiology</em>, <em>45</em>(6), 1887–1894. <a href="https://doi.org/10.1093/ije/dyw341">https://doi.org/10.1093/ije/dyw341</a>
</div>
</div>
</section></main><!-- /main --><div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://fantasyfootballanalytics.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<h3>Feedback</h3>

<div class="feedback">
    Please consider providing feedback about this textbook, so that I can make it as helpful as possible. You can provide feedback at the following link:
    
    <a href="https://forms.gle/LsnVKwqmS1VuxWD18">https://forms.gle/LsnVKwqmS1VuxWD18</a>
</div>

<h3>Email Notification</h3>

<div class="rmdsale">
The online version of this book will remain open access. If you want to know when the print version of the book is for sale, enter your email below so I can let you know.
<br><iframe src="https://docs.google.com/forms/d/e/1FAIpQLSccMKaTBXzMBmcy4myCNQnL8mCgRczh0Eg_Pw3c15bork7-xQ/viewform?embedded=true" width="640" height="750" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>

</div>
<script id="dsq-count-scr" src="//fantasyfootballanalytics.disqus.com/count.js" async=""></script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/isaactpetersen\.github\.io\/Fantasy-Football-Analytics-Textbook");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./mixed-models.html" class="pagination-link" aria-label="Mixed Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mixed Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cognitive-bias.html" class="pagination-link" aria-label="Heuristics and Cognitive Biases in Prediction">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Heuristics and Cognitive Biases in Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>“Fantasy Football Analytics: Statistics, Prediction, and Empiricism Using R” was written by <a href="https://psychology.uiowa.edu/people/isaac-petersen">Isaac T. Petersen</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/edit/main/causal-inference.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Fantasy-Football-Analytics-Textbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>