# Sports and Cognitive Psychology {#sec-sportsCognitivePsychology}

## Getting Started {#sec-sportsCognitivePsychologyGettingStarted}

### Load Packages {#sec-sportsCognitivePsychologyLoadPackages}

```{r}
library("nflreadr")
library("tidyverse")
library("ggtext")
```

### Download Football Data {#sec-sportsCognitivePsychologyDownloadFootballData}

```{r}
#| eval: false
#| include: false

load(file = file.path(path, "/OneDrive - University of Iowa/Teaching/Courses/Fantasy Football/Data/nfl_pbp.RData", fsep = ""))
load(file = file.path(path, "/OneDrive - University of Iowa/Teaching/Courses/Fantasy Football/Data/nfl_4thdown.RData", fsep = ""))
```

```{r}
load(file = "./data/nfl_pbp.RData")
load(file = "./data/nfl_4thdown.RData")
```

## Overview {#sec-sportsCognitivePsychologyOverview}

There are a number of [ways in which analytics have changed sports](https://stacker.com/sports/15-ways-analytics-has-changed-sports) (archived at <https://perma.cc/PQ5R-TWFA>).
Here is a summary of some of the key ways that analytics has led to changes.

Much of the history of analytics in sports traces back to Bill James.
James was a member of the Society for American Baseball Research (SABR).
He published a series of Baseball Abstracts, which included players' statistics.
James published the first Baseball Abstract in 1977 (<https://www.pbs.org/thinktank/transcript1197.html>; archived at <https://www.pbs.org/thinktank/transcript1197.html>).
He coined the term Sabermetrics (which was originally named SABRmetrics, based on the name of the society) to refer to advanced metrics and statistical/empirical analysis of baseball.
James believed that traditional statistics like batting average, runs batted in (RBIs), and pitchers' wins did not reflect a player's true value—i.e., their contribution to the team's success.
Instead, he advocated for the use of more advanced metrics that could provide a deeper understanding of a player's performance and value such as on-base percentage (OBP), slugging percentage (SLG), wins above replacement (WAR), and fielding independent pitching (FIP).
He also developed advanced metrics such as runs created (RC) and defense efficiency rating (DER).

James' ideas were slow to catch on among those in baseball.
Neverthless, some people eventually caught on to his ideas—and to good success.
Billy Beane, a general manager, used Sabermetrics to help the Oakland Athletics, a small market team with a limited budget, better compete with teams with larger budgets.
He used statistics such as on-base percentage to identify player value more accurately, especially for identifying undervalued players.
The story was described in Michael Lewis' book, Moneyball, which was turned into a movie.
Following publication of Moneyball, Theo Epstein, who was president of the Boston Red Sox and then of the Chicago Cubs, used sabermetrics to help each win the World Series.

In addition to teams using Sabermetrics to evaluate player talent, teams also began to frequently use statistical analysis to inform decision making during games, which led to key changes in the style of play.
For instace, defensive shifts—where defensive players moved to locations on the field where particular hitters were most likely to hit the ball—became more common, attempts to steal bases became less common, there were fewer bunts, batters took more pitches (i.e., watched more pitches without swinging), there were more frequent pitching changes (for particular pitcher–batter matchups; such as to have a right-handed pitcher face a left-handed batter or vice versa), and a greater focus on velocity and spin rate among pitchers.
Some of these analytics-driven changes in play style eventually led Major League Baseball (MLB) to make rule changes in an attempt to make the game more exciting to watch, including banning defensive shifts, reducing the number of pitching changes allowed, and making the bases larger and easier to steal.

Although baseball was one of the first major sports to embrace analytics, other sports have been transformed by analytics, as well.
For instance, in basketball, there has been a greater focus on three points and buckets close to the rim (e.g., dunks and layups), with way fewer midrange shots.
Moreover, star players rest more games.

Football has also seen greater use of analytics, although its uptake has been somewhat slower than in many other sports.
When asked about how he makes the decision about whether to go for two after a touchdown, Steelers Head Coach Mike Tomlin stated:

> We work a menu of plays in that area over the course of the week.
> We rank them at the latter part of the week, and then we get into the stadium and we play it by ear.
> A lot of it has to do wiht the feel or the flow of the game.
> Maybe what personnel group we think they're going to match our personnel group with.
> As we start to play and work the ball down the field on the drives that produce the touchdowns before the point after, we have a little inclination of what their personality might be at least in terms of matching our personnel.
> All of those things weigh into the decision.
> It legitimately is a feel thing.
> I think that's why you play the game.
> You can take analytics to baseball and things like that but football is always going to be football.
> I got a lot of respect for analytics and numbers, but I'm not going to make judgements based on those numbers.
> The game is the game.
> It's an emotional one played by emotional and driven men.
> That's an element of the game you can't measure.
> Often times decisions such as that weigh heavily into the equation.
> 
> --- [Steelers Head Coach Mike Tomlin, 2015](https://steelersdepot.com/2015/09/tomlin-prefers-feel-over-analytics/) (archived at <https://perma.cc/7CHJ-BTWX>)

That is, Mike Tomlin, suggested that he does not take into account analytics when making decisions.
Perhaps that is why the Pittsburgh Steelers were voted [one of the least analytically advanced teams](https://www.espn.com/nfl/story/_/id/29939438/2020-nfl-analytics-survey-which-teams-most-least-analytically-inclined) in the NFL in 2020 (archived at <https://perma.cc/R7FA-HGGB>).

A player talent evaluator for the NFL noted that [many people around the league believe that the use of analytics is better suited for baseball than football](https://www.cleveland.com/browns/2016/01/in_an_nfl_divided_over_analyti.html) because baseball involves more games, players, and one-on-one matchups (archived at <https://web.archive.org/web/20200803205803/https://www.cleveland.com/browns/2016/01/in_an_nfl_divided_over_analyti.html>).
By contrast, player performance in football may be more dependent on teammates and playcalls.
The [player talent evaluator noted](https://www.cleveland.com/browns/2016/01/in_an_nfl_divided_over_analyti.html), "In football they don't know how to use all the numbers yet...They have the data, they have all these different stats but the people I have talked to aren't completely sure how to use it." (archived at <https://web.archive.org/web/20200803205803/https://www.cleveland.com/browns/2016/01/in_an_nfl_divided_over_analyti.html>).

Nevertheless, more and more people around the league are using analytics; for examples of articles, see [here](https://www.theringer.com/2018/12/19/nfl/nfl-analytics-revolution) (archived at <https://perma.cc/7BKP-A4GJ>)  and [here](https://www.samford.edu/sports-analytics/fans/2020/The-Future-of-NFL-Data-Analytics) (archived at <https://perma.cc/WXE3-53E6>).
Head Coach Doug Peterson heavily relied on analytics with the Philadelphia Eagles to help them win the 2017 Super Bowl; for more information, see [here](https://www.forbes.com/sites/liamfox/2021/08/12/how-the-nfl-uses-analytics-according-to-the-lead-analyst-of-a-super-bowl-champion/) (archived at <https://perma.cc/49KQ-R785>) and [here](https://www.nfl.com/news/super-bowl-lii-how-the-2017-philadelphia-eagles-were-built-0ap3000000912753) (archived at <https://perma.cc/2GRF-8Z5K>).

Examples of changes in football due to the use of analytics include more often going for it on fourth down, a greater emphasis on the passing game, drafting Running Backs later in the draft (and, more generally, valuing Running Backs less), and trading down in the draft to obtain more low picks (rather than having fewer high picks) because top picks are frequently overvalued [@Massey2013].

## Coaching and Risk Aversion {#sec-coachingRiskAversion}

It had been known for a long time that going for it on fourth down would frequently increase a team's chances of winning.
Despite that, historically, teams rarely went for it on fourth down and elected to punt or kick a field goal instead.
It is curious that there was such a discrepancy between the decisions that would maximize teams' winning percentage and the decisions coaches actually made.
One potential explanation for the discrepancy is because of coaches' risk aversion.
As noted in @sec-cognitiveBiasesRiskAversion, when it is possible to experience either a gain or a loss from a decision, [loss aversion bias](#sec-cognitiveBiasesLossAversion) tends to lead people to make risk-averse decisions [@Kahneman2011].
According to this idea, in the case of failing to successfully convert on fourth down, coaches do not want to have to defend their decision to go for it to the media or the owner or general manager.
That is, they may often play *not to lose*, rather than to win, in order to keep their job.

```{r}
nfl_pbp4thDown <- nfl_pbp %>% 
  filter(down == 4) %>% 
  filter(!(play_type %in% c("no_play","qb_kneel")))

nfl_pbp4thDown$goForIt <- NA
nfl_pbp4thDown$goForIt[which(nfl_pbp4thDown$play_type %in% c("field_goal","punt"))] <- 0
nfl_pbp4thDown$goForIt[which(nfl_pbp4thDown$play_type %in% c("pass","run"))] <- 1

nfl_pbp4thDownPlotData <- nfl_pbp4thDown %>% 
  filter(!is.na(goForIt)) %>% 
  group_by(season) %>% 
  summarise(
    goForItPct = mean(goForIt, na.rm = TRUE),
    n = n(),
    sd = sd(goForIt),
    se = sd / n
  )

ggplot2::ggplot(
  data = nfl_pbp4thDownPlotData,
  ggplot2::aes(
    x = season,
    y = goForItPct)) +
  geom_point() +
  geom_line() +
  geom_ribbon(
    aes(
      y = goForItPct,
      ymin = goForItPct - qnorm(0.975)*se,
      ymax = goForItPct + qnorm(0.975)*se),
    alpha = 0.2) +
  scale_y_continuous(
    limits = c(0, NA)
  ) +
  ggplot2::labs(
    x = "Season",
    y = "Proportion of 4th Down Plays that are Attempts (to Get the First Down)",
    title = "4th Down Attempts (Proportion) by Season",
  ) +
  ggplot2::theme_classic()
```

Adapted from Ben Baldwin: https://www.nfl4th.com/articles/4th-down-research.html (archived at <https://perma.cc/S5D8-3NCU>)

```{r}
# labels on the plot
text_df <- tibble(
  label = c("NFL coaches<br>in <span style='color:#00BFC4'>**2024**</span>", "NFL coaches<br>in <span style='color:#F8766D'>**2014**</span>"),
  x = c(6, 8.2),
  y = c(80, 37),
  angle = c(10, 10),
  color = c("black", "black")
)

nfl_4thdown %>%
  filter(vegas_wp > .2, between(go_boost, -10, 10), season %in% c(2014, 2024)) %>%
  ggplot(
    aes(
      x = go_boost,
      y = go,
      color = as.factor(season))) + 
  ggtext::geom_richtext(
    data = text_df,   
    aes(
      x,
      y,
      label = label,
      angle = angle), 
    color = "black",
    fill = NA,
    label.color = NA,
    size = 5) + 
  geom_vline(xintercept = 0) +
  stat_smooth(
    method = "gam",
    method.args = list(gamma = 1),
    formula = y ~ s(x, bs = "cs", k = 10),
    show.legend = FALSE,
    se = FALSE,
    linewidth = 4) +
  # this is just to get the plot to draw the full 0 to 100 range
  geom_hline(
    yintercept = 100,
    alpha = 0) +
  geom_hline(
    yintercept = 0,
    alpha = 0) +
  ggplot2::theme_classic() +
  labs(
    x = "Gain in win probability by going for it",
    y = "Go-for-it percentage",
    subtitle = "4th down decisions in 2024 versus 2014, win prob. > 20%",
    title = glue::glue("How <span style='color:red'>math</span> is changing football")) +
  theme(
    legend.position = "none",
    plot.title = element_markdown(size = 22, hjust = 0.5),
    plot.subtitle = element_markdown(size = 14, hjust = 0.5),
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.title.y = element_text(size = 14, face = "bold")
  ) +
  scale_y_continuous(
    breaks = scales::pretty_breaks(n = 4),
    limits = c(0, 100),
    expand = c(0,0)) +
  scale_x_continuous(
    breaks = scales::pretty_breaks(n = 10),
    limits = c(-10, 10),
    expand = c(0,0)) +
  annotate(
    "text",
    x = -1.2,
    y = 70,
    label = "Should\nkick",
    color = "black",
    size = 5) +
  annotate(
    "text",
    x = 1.2,
    y = 70,
    label = "Should\ngo for it",
    color = "black",
    size = 5) +
  geom_segment(
    aes(
      x = -.1,
      y = 80,
      xend = -2,
      yend = 80),
    arrow = arrow(length = unit(0.05, "npc")),
    color = "black",
    linewidth = 2) +
  geom_segment(
    aes(
      x = .1,
      y = 80,
      xend = 2,
      yend = 80),
    arrow = arrow(length = unit(0.05, "npc")),
    color = "black",
    linewidth = 2)
```

## Conclusion {#sec-sportsCognitivePsychologyConclusion}

::: {.content-visible when-format="html"}

## Session Info {#sec-sportsCognitivePsychologySessionInfo}

```{r}
sessionInfo()
```

:::
