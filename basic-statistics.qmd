# Basic Statistics {#sec-basicStats}

## Getting Started {#sec-basicStatsGettingStarted}

### Load Packages {#sec-basicStatsLoadPackages}

```{r}
library("petersenlab")
library("pwr")
library("grid")
library("tidyverse")
```

## Descriptive Statistics {#sec-descriptiveStatistics}

Descriptive statistics are used to describe data.
For instance, they may be used to describe the center, spread, or shape of the data.
There are various indices of each.

### Center {#sec-descriptiveStatisticsCenter}

Indices to describe the *center* (central tendency) of a variable's data include:

- mean
- median
- mode

The mean of $X$ (written as: $\bar{X}$) is calculated as:

$$
\bar{X} = \frac{\sum X_i}{n} = \frac{X_1 + X_2 + ... + X_n}{n}
$$ {#eq-IQR}

That is, to compute the mean, sum all of the values and divide by the number of values ($n$).

The median is determined as the value at the 50th percentile (i.e., the value that is higher than 50% of the values and is lower than the other 50% of values).

The mode is the most common/frequent value.

Below is R code to estimate each:

```{r}

```

### Spread {#sec-descriptiveStatisticsSpread}

Indices to describe the *spread* (variability) of a variable's data include:

- standard deviation
- variance
- range
- minimum and maximum
- interquartile range (IQR)

The (sample) variance of $X$ (written as: $s^2$) is calculated as:

$$
s^2 = \frac{\sum (X_i - \bar{X})^2}{n-1}
$$ {#eq-variance}

The (sample) standard deviation of $X$ (written as: $s$) is calculated as:

$$
s = \sqrt{\frac{\sum (X_i - \bar{X})^2}{n-1}}
$$ {#eq-sd}

The range is calculated of $X$ is calculated as:

$$
\text{range} = \text{maximum} - \text{minimum}
$$ {#eq-range}

The interquartile range (IQR) is calculated as:

$$
\text{IQR} = Q_3 - Q_1
$$ {#eq-IQR}

where $Q_3$ is the score at the third quartile (i.e., 75th percentile), and $Q_1$ is the score at the first quartile (i.e., 25th percentile).

Below is R code to estimate each:

```{r}

```

### Shape {#sec-descriptiveStatisticsShape}

Indices to describe the *shape* of a variable's data include:

- skewness
- kurtosis

Below is R code to estimate each:

```{r}

```

### Combination {#sec-descriptiveStatisticsCombination}

To estimate multiple indices of center, spread, and shape of the data, you can use the following code:

```{r}
#psych::describe(mydata)

#mydata %>% 
#  summarise(across(
#      everything(),
#      .fns = list(
#        n = ~ length(na.omit(.)),
#        missingness = ~ mean(is.na(.)) * 100,
#        M = ~ mean(., na.rm = TRUE),
#        SD = ~ sd(., na.rm = TRUE),
#        min = ~ min(., na.rm = TRUE),
#        max = ~ max(., na.rm = TRUE),
#        range = ~ max(., na.rm = TRUE) - min(., na.rm = TRUE),
#        IQR = ~ IQR(., na.rm = TRUE),
#        median = ~ median(., na.rm = TRUE),
#        mode = ~ petersenlab::Mode(., multipleModes = "mean"),
#        skewness = ~ psych::skew(., na.rm = TRUE),
#        kurtosis = ~ psych::kurtosi(., na.rm = TRUE)),
#      .names = "{.col}.{.fn}")) %>%
#    pivot_longer(
#      cols = everything(),
#      names_to = c("variable","index"),
#      names_sep = "\\.") %>% 
#    pivot_wider(
#      names_from = index,
#      values_from = value)
```

## Inferential Statistics {#sec-inferentialStatistics}

Inferential statistics are used to draw inferences regarding whether there is (a) a difference in level on variable across groups or (b) an association between variables.
For instance, inferential statistics may be used to evaluate whether Quarterbacks tend to have longer careers compared to Running Backs.
Or, they could be used to evaluate whether number of carries is associated with injury likelihood.
To apply inferential statistics, we make use of the null hypothesis ($H_0$) and the alternative hypothesis ($H_1$).

### Null Hypothesis Significance Testing {#sec-nhst}

#### Null Hypothesis ($H_0$) {#sec-nullHypothesis}

When testing whether there are differences in level across groups on a variable of interest, the null hypothesis ($H_0$) is that there is <u>no difference</u> in level across groups.
For instance, when testing whether Quarterbacks tend to have longer careers compared to Running Backs, the null hypothesis ($H_0$) is that Quarterbacks do not systematically differ from Running Backs in the length of their career.

When testing whether there is an association between variables, the null hypothesis ($H_0$) is that there is <u>no association</u> between the variables.
For instance, when testing whether number of carries is associated with injury likelihood, the null hypothesis ($H_0$) is that there is no association between number of carries and injury likelihood.

#### Alternative Hypothesis ($H_1$) {#sec-alternativeHypothesis}

The alternative hypothesis ($H_1$) is the researcher's hypothesis that they want to evaluate.
An alternative hypothesis ($H_1$) might be directional (i.e., one-sided) or non-directional (i.e., two-sided).

Directional hypotheses specify a particular direction, such as which group will have larger scores or which direction (positive or negative) two variables will be associated.
Examples of directional hypotheses include:

- Quarterbacks have <u>longer</u> careers compared to Running Backs
- Number of carries is <u>positively</u> associated with injury likelihood

Non-directional hypotheses do not specify a particular direction.
For instance, non-directional hypotheses may state that two groups differ but do not specify which group will have larger scores.
Or, non-directional hypotheses may state that two variables are associated but do not state what the sign is of the association—i.e., positive or negative.
Examples of non-directional hypotheses include:

- Quarterbacks <u>differ</u> in the length of their careers compared to Running Backs
- Number of carries is <u>associated</u> with injury likelihood

#### Statistical Significance {#sec-statisticalSignificance}

In science, statistical significance is evaluated with the *p*-value.
The *p*-value does not represent the probability that you observed the result by chance.
The *p*-value represents a conditional probability—it examines the probability of one event given another event.
In particular, the *p*-value evaluates the likelihood that you would detect a result as at least as extreme as the one observed (in terms of the magnitude of the difference or of the association) given that the null hypothesis ($H_0$) is true.

This can be expressed in conditional probability notation, $Pr(A | B)$, which is the probability (likelihood) of event A occurring given that event B occurred (or given condition B).

The conditional probability notation for a left-tailed directional test (i.e., Quarterbacks have <u>shorter</u> careers than Running Backs; or number of carries is <u>negatively</u> associated with injury likelihood) is in @eq-pvalueLeftTailed.

$$
p\text{-value} = Pr(T \le t | H_0)
$$ {#eq-pvalueLeftTailed}

where $T$ is the test statistic of interest (e.g., the distribution of $t$-, $r-$, or $F$ values, depending on the test) and $t$ is the observed test statistic (e.g., $t$-, $r-$, or $F$-coefficient, depending on the test).

The conditional probability notation for a right-tailed directional test (i.e., Quarterbacks have <u>longer</u> careers than Running Backs; or number of carries is <u>positively</u> associated with injury likelihood) is in @eq-pvalueRightTailed.

$$
p\text{-value} = Pr(T \ge t | H_0)
$$ {#eq-pvalueRightTailed}

The conditional probability notation for a two-tailed non-directional test (i.e., Quarterbacks <u>differ</u> in the length of their careers compared to Running Backs; or number of carries is <u>associated</u> with injury likelihood) is in @eq-pvalueTwoTailed.

$$
p\text{-value} = 2 \times \text{min}(Pr(T \le t | H_0), Pr(T \ge t | H_0))
$$ {#eq-pvalueTwoTailed}

where `min(a, b)` is the smaller number of `a` and `b`.

If the distribution of the test statistic is symmetric around zero, the *p*-value for the two-tailed non-directional test simplifies to @eq-pvalueTwoTailedSimple.

$$
p\text{-value} = 2 \times Pr(T \ge |t| | H_0)
$$ {#eq-pvalueTwoTailedSimple}

Nevertheless, to be conservative (i.e., to avoid false positive/Type I errors), many researchers use two-tailed *p*-values regardless whether their hypothesis is one- or two-tailed.

For a test of group differences, the *p*-value evaluates the likelihood that you would observe a difference as large or larger than the one you observed between the groups if there were no systematic difference between the groups.
For instance, when evaluating whether Quarterbacks have <u>longer</u> careers than Running Backs, and you observed a mean difference of 0.03 years, the *p*-value evaluates the likelihood that you would observe a difference as larger or larger than 0.03 years between the groups if Quarterbacks do not differ from Running Backs in terms of the length of their career.

For a test of whether two variables are associated, the *p*-value evaluates the likelihood that you would observe an association as strong or stronger than the one you observed between the groups if there were no association between the variables.
For instance, when evaluating whether number of carries is <u>positively</u> associated with injury likelihood, and you observed a correlation coefficient of $r = .25$ between number of carries and injury likelihood, the *p*-value evaluates the likelihood that you would observe a correlation as strong or stronger than $r = .25$ between the variables if number of carries is not associated with injury likelihood.

Using what is called null-hypothesis significance testing (NHST), we consider an effect to be *statistically significant* if the *p*-value is less than some threshold, called the *alpha level*.
In science, we typically want to be conservative because a false positive (i.e., Type I error) is considered more problematic than a false negative (i.e., Type II error).
That is, we would rather say an effect does not exist when it really does than to say an effect does exist when it really does not.
Thus, we typically set the alpha level to a low value, commonly .05.
Then, we would consider an effect to be *statistically significant* if the *p*-value is less than .05.
That is, there is a small chance (5%; or 1 in 20 times) that we would observe an effect at least as extreme as the effect observed, if the null hypothesis were true.
So, you might expect around 5% of tests where the null hypothesis is true to be statistically significant just by chance.
We could lower the rate of Type II (i.e., false negative) errors—i.e., we could detect more effects—if we set the alpha level to a higher value (e.g., .10); however, raising the alpha level would raise the possibility of Type I (false positive) errors.

If the *p*-value is less than .05, we reject the null hypothesis ($H_0$) that there was no difference or association.
Thus, we conclude that there was a statistically significant (non-zero) difference or association.
If the *p*-value is greater than .05, we fail to reject the null hypothesis; the difference/association was not statistically significant.
Thus, we do not have confidence that there was a difference or association.
However, we do not accept the null hypothesis; it could be there we did not observe an effect because we did not have adequate power to detect the effect—e.g., if the effect size was small, the data were noisy, and the sample size was small and/or unrepresentative.

There are four general possibilities of decision making outcomes when performing null-hypothesis significance testing:

1. We (correctly) reject the null hypothesis when it is in fact false ($1 - \beta$).
This is a true positive.
For instance, we may correctly determine that Quarterbacks have longer careers than Running Backs.
1. We (correctly) fail to reject the null hypothesis when it is in fact true ($1 - \alpha$).
This is a true negative.
For instance, we may correctly determine that Quarterbacks do not have longer careers than Running Backs.
1. We (incorrectly) reject the null hypothesis when it is in fact true ($\alpha$).
This is a false positive.
When performing null hypothesis testing, a false positive is known as a Type I error.
For instance, we may incorrectly determine that Quarterbacks have longer careers than Running Backs when, in fact, Quarterbacks and Running Backs do not differ in their career length.
1. We (incorrectly) fail to reject the null hypothesis when it is in fact false ($\beta$).
This is a false negative.
When performing null hypothesis testing, a false negative is known as a Type II error.
For instance, we may incorrectly determine that Quarterbacks and Running Backs do not differ in their career length when, in fact, Quarterbacks have longer careers than Running Backs.

A two-by-two confusion matrix for null-hypothesis significance testing is in @fig-nhstConfusionMatrix.

::: {#fig-nhstConfusionMatrix}
![](images/nhstConfusionMatrix.png)

A Two-by-Two Confusion Matrix for Null-Hypothesis Significance Testing.
:::

In statistics, *power* is the probability of detecting an effect, if, in fact, the effect exists.
Otherwise said, power is the probability of rejecting the null hypothesis, if, in fact, the null hypothesis is false.
Power is influenced by several variables:

- the sample size (*N*): the larger the *N*, the greater the power
    - for group comparisons, the power depends on the sample size of each group
- the [effect size](#sec-practicalSignificance): the larger the effect, the greater the power
    - for group comparisons, larger effect sizes reflect:
        - larger between-group variance, and
        - smaller within-group variance (i.e., strong measurement precision, i.e., [reliability](#sec-reliability))
- the alpha level: the researcher specifies the alpha level (though it is typically set at .05); the higher the alpha level, the greater the power; however, the higher we set the alpha level, the higher the likelihood of Type I errors (false positives)
- one- versus two-tailed tests: one-tailed tests have higher power than two-tailed tests
- [within-subject](#sec-withinSubject) versus [between-subject](#sec-betweenSubject) comparisons: [within-subject designs](#sec-withinSubject) tend to have greater power than [between-subject designs](#sec-betweenSubject)

A plot of statistical power is in @fig-nhst.

```{r}
#| label: fig-nhst
#| fig-cap: "Statistical Power (Adapted from Kristoffer Magnusson: <https://rpsychologist.com/creating-a-typical-textbook-illustration-of-statistical-power-using-either-ggplot-or-base-graphics>; archived at <https://perma.cc/FG3J-85L6>). The dashed line represents the critical value or threshold."
#| code-fold: true

m1 <- 0  # mu H0
sd1 <- 1.5 # sigma H0
m2 <- 3.5 # mu HA
sd2 <- 1.5 # sigma HA
 
z_crit <- qnorm(1-(0.05/2), m1, sd1)
 
# set length of tails
min1 <- m1-sd1*4
max1 <- m1+sd1*4
min2 <- m2-sd2*4
max2 <- m2+sd2*4          
# create x sequence
x <- seq(min(min1,min2), max(max1, max2), .01)
# generate normal dist #1
y1 <- dnorm(x, m1, sd1)
# put in data frame
df1 <- data.frame("x" = x, "y" = y1)
# generate normal dist #2
y2 <- dnorm(x, m2, sd2)
# put in data frame
df2 <- data.frame("x" = x, "y" = y2)
 
# Alpha polygon
y.poly <- pmin(y1,y2)
poly1 <- data.frame(x=x, y=y.poly)
poly1 <- poly1[poly1$x >= z_crit, ] 
poly1<-rbind(poly1, c(z_crit, 0))  # add lower-left corner
 
# Beta polygon
poly2 <- df2
poly2 <- poly2[poly2$x <= z_crit,] 
poly2<-rbind(poly2, c(z_crit, 0))  # add lower-left corner
 
# power polygon; 1-beta
poly3 <- df2
poly3 <- poly3[poly3$x >= z_crit,] 
poly3 <-rbind(poly3, c(z_crit, 0))  # add lower-left corner
 
# combine polygons. 
poly1$id <- 3 # alpha, give it the highest number to make it the top layer
poly2$id <- 2 # beta
poly3$id <- 1 # power; 1 - beta
poly <- rbind(poly1, poly2, poly3)
poly$id <- factor(poly$id,  labels=c("power","beta","alpha"))

# plot with ggplot2
ggplot(poly, aes(x,y, fill=id, group=id)) +
  geom_polygon(show.legend=F, alpha=I(8/10)) +
  # add line for treatment group
  geom_line(data=df1, aes(x,y, color="H0", group=NULL, fill=NULL), linewidth=1.5, show_guide=F) + 
  # add line for treatment group. These lines could be combined into one dataframe.
  geom_line(data=df2, aes(color="HA", group=NULL, fill=NULL),linewidth=1.5, show_guide=F) +
  # add vlines for z_crit
  geom_vline(xintercept = z_crit, linewidth=1, linetype="dashed") +
  # change colors 
  scale_color_manual("Group", 
                     values= c("HA" = "#981e0b","H0" = "black")) +
  scale_fill_manual("test", values= c("alpha" = "#0d6374","beta" = "#be805e","power"="#7cecee")) +
  # beta arrow
  annotate("segment", x=0.1, y=0.045, xend=1.3, yend=0.01, arrow = arrow(length = unit(0.3, "cm")), linewidth=1) +
  annotate("text", label="beta", x=0, y=0.05, parse=T, size=8) +
  # alpha arrow
  annotate("segment", x=4, y=0.043, xend=3.4, yend=0.01, arrow = arrow(length = unit(0.3, "cm")), linewidth=1) +
  annotate("text", label="frac(alpha,2)", x=4.2, y=0.05, parse=T, size=8) +
  # power arrow
  annotate("segment", x=6, y=0.2, xend=4.5, yend=0.15, arrow = arrow(length = unit(0.3, "cm")), linewidth=1) +
  annotate("text", label=expression(paste(1-beta, "  (\"power\")")), x=6.1, y=0.21, parse=T, size=8) +
  # H_0 title
  annotate("text", label="H[0]", x=m1, y=0.28, parse=T, size=8) +
  # H_a title
  annotate("text", label="H[1]", x=m2, y=0.28, parse=T, size=8) +
  ggtitle("Statistical Power") +
  # remove some elements
  theme(
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    plot.background = element_rect(fill="white"),
    panel.border = element_blank(),
    axis.line = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    plot.title = element_text(size=22))
```

Interactive visualizations by Kristoffer Magnusson on *p*-values and null-hypothesis significance testing are below:

- <https://rpsychologist.com/pvalue/> (archived at <https://perma.cc/JP9F-9ZVY>)
- <https://rpsychologist.com/d3/pdist/> (archived at <https://perma.cc/BE96-8LSJ>)
- <https://rpsychologist.com/d3/nhst/> (archived at <https://perma.cc/ZU9A-37F3>)

Twelve misconceptions about *p*-values [@Goodman2008] are in @tbl-pValueMisconceptions.

| Number | Misconception                                                                                                                              |
|:-------|:-------------------------------------------------------------------------------------------------------------------------------------------|
| 1      | If $p = .05$, the null hypothesis has only a 5% chance of being true.                                                                      |
| 2      | A nonsignificant difference (eg, $p > .05$) means there is no difference between groups.                                                   |
| 3      | A statistically significant finding is clinically important.                                                                               |
| 4      | Studies with $p$-values on opposite sides of .05 are conflicting.                                                                          |
| 5      | Studies with the same $p$-value provide the same evidence against the null hypothesis.                                                     |
| 6      | $p = .05$ means that we have observed data that would occur only 5% of the time under the null hypothesis.                                 |
| 7      | $p = .05$ and $p < .05$ mean the same thing.                                                                                               |
| 8      | $p$-values are properly written as inequalities (e.g., "$p \le .05$" when $p = .015$).                                                     |
| 9      | $p = .05$ means that if you reject the null hypothesis, the probability of a Type I error is only 5%.                                      |
| 10     | With a $p = .05$ threshold for significance, the chance of a Type I error will be 5%.                                                      |
| 11     | You should use a one-sided $p$-value when you don't care about a result in one direction, or a difference in that direction is impossible. |
| 12     | A scientific conclusion or treatment policy should be based on whether or not the $p$-value is significant.                                |

: Twelve Misconceptions About *p*-Values from @Goodman2008. Goodman also provides a discussion about why each statement is false. {#tbl-pValueMisconceptions}

Statistical significance involves the *consistency* of an effect/association/difference; it suggests that the association/difference is reliably non-zero.
However, just because something is statistically significant does not mean that it is important.
In addition to statistical significance, it is also important to consider practical significance.

### Practical Significance {#sec-practicalSignificance}

*Practical significance* deals with how large or important the effect/association/difference is.
It is based on the magnitude of the effect, called the *effect size*.
Effect size can be quantified in various ways including:

- Cohen's $d$
- Standardized regression coefficient (beta; $\beta$)
- Correlation coefficient ($r$)
- Coefficient of determination ($R^2$)
- Eta squared ($\eta^2$)
- Partial eta squared ($\eta_p^2$)

Cohen's $d$ is calculated as in @eq-cohensD:

$$
\begin{aligned}
  d &= \frac{\text{mean difference}}{\text{pooled standard deviation}} \\
   &= \frac{X_1 - X_2}{s} \\
\end{aligned}
$$ {#eq-cohensD}

where:

$$
s = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
$$ {#eq-pooledStandardDeviation}

where $n_1$ and $n_2$ is the sample size of group 1 and group 2, respectively, and $s_1$ and $s_2$ is the standard deviation of group 1 and group 2, respectively.

Cohen's $f$ is commonly used in ANOVA, and is calculated as in @eq-cohensF:

$$
\begin{aligned}
  f &= \sqrt{\frac{R^2}{1 - R^2}} \\
    &= \sqrt{\frac{\eta^2}{1 - \eta^2}} \\
\end{aligned}
$$ {#eq-cohensF}

Cohen's $f^2$ is commonly used in regression, and is calculated as in @eq-cohensFsquared:

$$
\begin{aligned}
  f^2 &= \frac{R^2}{1 - R^2} \\
    &= \frac{\eta^2}{1 - \eta^2} \\
\end{aligned}
$$ {#eq-cohensFsquared}

$R^2$ is commonly used in regression, and is calculated as in @eq-rSquared:

$$
\begin{aligned}
  R^2 &= 1 - \frac{\sum (Y_i - \hat{Y}_i)^2}{\sum (Y_i - \bar{Y})^2} \\
      &= 1 - \frac{SS_{\text{residual}}}{SS_{\text{total}}} \\
      &= 1 - \frac{\text{sum of squared residuals}}{\text{total sum of squares}}
      
\end{aligned}
$$ {#eq-rSquared}

where $Y_i$ is the observed value of the [outcome variable](#sec-correlationalStudy) for the $i$th observation, $\hat{Y}_i$ is the model predicted value for the $i$th observation, $\bar{Y}$ is the mean of the observed values of the [outcome variable](#sec-correlationalStudy).
The total sum of squares is an index of the total variation in the [outcome variable](#sec-correlationalStudy).

Effect size thresholds [@McGrath2006] for small, medium, and large effect sizes are in @tbl-effectSizeThresholds.

| Effect Size Index                                   | Small       | Medium      | Large       |
|:----------------------------------------------------|:------------|:------------|:------------|
| Cohen's $d$                                         | $\ge |.20|$ | $\ge |.50|$ | $\ge |.80|$ |
| Standardized regression coefficient (beta; $\beta$) | $\ge |.10|$ | $\ge |.24|$ | $\ge |.37|$ |
| Correlation coefficient ($r$)                       | $\ge |.10|$ | $\ge |.24|$ | $\ge |.37|$ |
| Cohen's $f$                                         | $\ge .10$   | $\ge .25$   | $\ge .40$   |
| Cohen's $f^2$                                       | $\ge .01$   | $\ge .06$   | $\ge .16$   |
| Coefficient of determination ($R^2$)                | $\ge .01$   | $\ge .06$   | $\ge .14$   |
| Eta squared ($\eta^2$)                              | $\ge .01$   | $\ge .06$   | $\ge .14$   |
| Partial eta squared ($\eta_p^2$)                    | $\ge .01$   | $\ge .06$   | $\ge .14$   |

: Effect Size Thresholds for Small, Medium, and Large Effect Sizes. {#tbl-effectSizeThresholds}

## Statistical Decision Tree {#sec-statisticalDecisionTree}

An example statistical decision tree is depicted in @fig-statisticalDecisionTree.

::: {#fig-statisticalDecisionTree}
![](images/statisticalDecisionTree.png)

A Statistical Decision Tree For Choosing an Appropriate Statistical Procedure. Adapted from: <https://commons.wikimedia.org/wiki/File:InferentialStatisticalDecisionMakingTrees.pdf>. The original source is: Corston, R. & Colman, A. M. (2000). *A crash course in SPSS for Windows*. Wiley-Blackwell. Changes were made to the original, including the addition of several statistical tests.
:::

However, many statistical tests can be re-formulated in a regression framework, as in @fig-statisticalDecisionTreeRegression.

::: {#fig-statisticalDecisionTreeRegression}
![](images/statisticalDecisionTreeRegression.png)

A Statistical Decision Tree For Choosing an Appropriate Statistical Procedure, Re-Formulated in a Regression Framework. Adapted from: <https://commons.wikimedia.org/wiki/File:InferentialStatisticalDecisionMakingTrees.pdf>. The original source is: Corston, R. & Colman, A. M. (2000). *A crash course in SPSS for Windows*. Wiley-Blackwell. Changes were made to the original, including re-formulating the tests in a regression framework.
:::

For an online, interactive statistical decision tree to help you decide which statistical analysis to use, see here: <https://www.statsflowchart.co.uk>

## Statistical Tests {#sec-statisticalTests}

### *t*-Test {#sec-tTest}

There are several *t*-tests:

- one-sample *t*-test
- two-samples *t*-test
    - independent samples *t*-test
    - paired samples *t*-test

A one-sample *t*-test is used to evaluate whether a sample mean differs systematically from a particular value.
The null hypothesis is that the sample mean does not differ systematically from the pre-specified value.
The alternative hypothesis is that the sample mean differs systematically from the pre-specified value.
For instance, let's say you want to test out a new draft strategy.
You could participate in a mock draft and draft players using the new strategy.
Then, you could use a one-sample *t*-test to evaluate whether your new draft strategy yields players with more projected points than the average of players' projected points for other teams.

Two-samples *t*-tests are used to test for differences between scores of two groups.
If the two groups are independent, the independent samples *t*-test is used.
If the two groups involve paired samples, the paired samples *t*-test is used.
The null hypothesis is that the mean of group 1 does not differ systematically from the mean of group 2.
The alternative hypothesis is that the mean of group 1 differs systematically from the mean of group 2.
For instance, you could use an independent-samples *t*-test if you want to examine whether Quarterbacks tend to have have longer careers than Running Backs.
By contrast, you could use a paired samples *t*-test if you want to examine whether Quarterbacks tend to score more points in the second year of their contract compared to their rookie year, because the same subjects were assessed twice (i.e., a [within-subject design](#sec-withinSubject)).

### Analysis of Variance {#sec-anova}

Analysis of variance (ANOVA) allows examining whether groups differ systematically as a function of one or more factors.
There are multiple variants of ANOVA:

- one-way ANOVA
- factorial ANOVA
- repeated measures ANOVA (RM-ANOVA)
- multivariate ANOVA (MANOVA)

Like two-samples *t*-tests, ANOVA allows examining whether groups differ as a function of an [independent variable](#sec-experiment).
However, unlike a *t*-test, ANOVA allows examining multiple multiple [independent variables](#sec-experiment) and more than two groups.
The null hypothesis is that the the groups' mean value does not differ systematically.
The alternative hypothesis is that the groups' mean value differs systematically.

A one-way ANOVA examines whether two or more groups differ as a function of an [independent variable](#sec-experiment).
For instance, you could use a one-way ANOVA to evaluate if you want to evaluate whether multiple positions differ in their length of career.
Factorial ANOVA examines whether two or more groups differ as a function of multiple [independent variables](#sec-experiment).
For instance, you could use factorial ANOVA to evaluate whether one's length of career depends on one's position and weight.
Repeated measures ANOVA examines whether scores differ across repeated measures (e.g., across time) for the same participants.
For instance, you could use repeated-measures ANOVA to evaluate whether rookies score more points as the season progresses.
Multivariate ANOVA examines whether multiple [dependent variables](#sec-experiment) differ as a function of one or more factor(s).
For instance, you could use MANOVA to evaluate whether one's contract length and pay differ as a function of one's position.

### Correlation {#sec-correlation}

Correlation examines the association between a [predictor](#sec-correlationalStudy) and [outcome](#sec-correlationalStudy) variable.
The null hypothesis is that the the two variables are not associated.
The alternative hypothesis is that the two variables are associated.

The Pearson correlation coefficient ($r$) is calculated as in @eq-pearsonCorrelation:

$$
r = \frac{\sum (X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum (X_i - \bar{X})^2 \sum (Y_i - \bar{Y})^2}}
$$ {#eq-pearsonCorrelation}

where $X$ is the [predictor variable](#sec-correlationalStudy) and $Y$ is the [outcome variable](#sec-correlationalStudy).

### (Multiple) Regression {#sec-regression}

Regression, like correlation, examines the association between a [predictor](#sec-correlationalStudy) and [outcome](#sec-correlationalStudy) variable.
However, unlike correlation, regression allows multiple [predictor variables](#sec-correlationalStudy).

Regression with one predictor takes the form of @eq-regression:

$$
y = \beta_0 + \beta_1x_1 + \epsilon
$$ {#eq-regression}

where $y$ is the [outcome variable](#sec-correlationalStudy), $\beta_0$ is the intercept, $\beta_1$ is the slope, $x_1$ is the [predictor variable](#sec-correlationalStudy), and $\epsilon$ is the error term.

```{r}
#| include: false
#| eval: false

set.seed(52242)
regression <- data.frame(outcome = rnorm(40, mean = 5, sd = 2))

regression$predictor <- complement(regression$outcome, .5)
regression$predictor <- regression$predictor + abs(min(regression$predictor))

lm(
  outcome ~ predictor,
  data = regression)

ggplot2::ggplot(
  data = regression,
  ggplot2::aes(
    x = predictor,
    y = outcome,
  )
) +
  ggplot2::geom_point() +
  ggplot2::geom_smooth(
    method = "lm",
    linewidth = 2,
    se = FALSE,
    fullrange = TRUE) +
  ggplot2::scale_x_continuous(
    lim = c(0,8),
    breaks = seq(from = 0, to = 8, by = 2),
    expand = c(0,0)
  ) +
  ggplot2::scale_y_continuous(
    lim = c(0,8),
    breaks = seq(from = 0, to = 8, by = 2),
    expand = c(0,0)
  ) +
  ggplot2::labs(
    x = "Predictor Variable",
    y = "Outcome Variable",
    title = "Regression Best-Fit Line"
  ) +
  ggplot2::theme_classic(
    base_size = 16) +
  ggplot2::theme(legend.title = element_blank())

ggsave("./images/regression.pdf", width = 6, height = 6)
```

A regression line is depicted in @fig-regression.

::: {#fig-regression}
![](images/regression.png)

A Regression Best-Fit Line.
:::

Regression with multiple predictors—i.e., multiple regression—takes the form of @eq-multipleRegression:

$$
y = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_px_p + \epsilon
$$ {#eq-multipleRegression}

where $p$ is the number of [predictor variables](#sec-correlationalStudy).

The null hypothesis is that the the [predictor variable(s)](#sec-correlationalStudy) are not associated with the [outcome variable](#sec-correlationalStudy).
The alternative hypothesis is that the [predictor variable(s)](#sec-correlationalStudy) are associated with the [outcome variable](#sec-correlationalStudy).

### Chi-Square Test {#sec-chisquare}

There are two primary types of chi-square tests:

- chi-square goodness-of-fit test
- chi-square test for association (aka test of independence)

The chi-square goodness-of-fit test evaluates whether a set of categorical data came from a specified distribution.
The null hypothesis is that the data came from the specified distribution.
The alternative hypothesis is that the data did not come from the specified distribution.

The chi-square test for association evaluates whether two categorical variables are associated.
The null hypothesis is that the two variables are not associated.
The alternative hypothesis is that the two variables are associated.

### Formulating Statistical Tests in Terms of Partitioned Variance {#sec-statisticalTestsPartitionedVariance}

Many statistical tests can be formulated in terms of partitioned variance.

For instance, the *t* statistic from the independent-samples *t*-test and the *F* statistic from ANOVA can be thought of as the ratio of between-group variance to within-group variance, as in @eq-tTestPartitionedVariance:

$$
t \text{ or } F = \frac{\text{between-group variance}}{\text{within-group variance}}
$$ {#eq-tTestPartitionedVariance}

The correlation coefficient can be thought of as the ratio of shared variance (i.e., covariance) to total variance, as in @eq-correlationPartitionedVariance:

$$
r = \frac{\text{shared variance}}{\text{total variance}}
$$ {#eq-correlationPartitionedVariance}

The coefficient of determination ($R^2$) is the proportion of variance in the [outcome variable](#sec-correlationalStudy) that is explained by the [predictor variables](#sec-correlationalStudy).
The coefficient of determination can be expressed as the ratio of variance explained in the [outcome variable](#sec-correlationalStudy) to the total variance in the [outcome variable](#sec-correlationalStudy), as in @eq-coefficientOfDetermination:

$$
R^2 = \frac{\text{variance explained in the outcome variable}}{\text{total variance in the outcome variable}}
$$ {#eq-coefficientOfDetermination}

### Critical Value {#sec-statisticalTestsCriticalValue}

The critical value is the test value for a given test, above which the effect is considered to be [statistically significant](#sec-statisticalSignificance).
The critical value for [statistical significance](#sec-statisticalSignificance) for each test can be determined based on the degrees of freedom and alpha level.
The degrees of freedom (*df*) refer to the number of values in the calculation of a test statistic that are free to vary.

```{r}
alpha <- .05
N <- 200
nGroup1 <- 150
nGroup2 <- 150
numGroups <- 4
numLevelsFactorA <- 3
numLevelsFactorB <- 4
numTimepoints <- 4
numPredictors <- 5
numCategories <- 6
numRows <- 5
numColumns <- 2
```

#### One-Sample *t*-Test {#sec-statisticalTestsCriticalValueOneSampleTtest}

For a one-sample *t*-test, the degrees of freedom is in @eq-dfOneSampleTtest:

$$
df = N - 1
$$ {#eq-dfOneSampleTtest}

where $N$ is sample size.

```{r}
df_oneSampleTtest <- N - 1
```

One-tailed test:

```{r}
qt(1 - alpha, df_oneSampleTtest)
```

Two-tailed test:

```{r}
qt(1 - alpha/2, df_oneSampleTtest)
```

#### Independent-Samples *t*-Test {#sec-statisticalTestsCriticalValueIndependentSamplesTtest}

For an independent-samples *t*-test, the degrees of freedom is in @eq-dfIndependentSamplesTtest:

$$
df = n_1 + n_2 - 2
$$ {#eq-dfIndependentSamplesTtest}

where $n_1$ is the sample size of group 1 and $n_2$ is the sample size of group 2.

```{r}
df_independentSamplesTtest <- nGroup1 + nGroup2 - 2
```

One-tailed test:

```{r}
qt(1 - alpha, df_independentSamplesTtest)
```

Two-tailed test:

```{r}
qt(1 - alpha/2, df_independentSamplesTtest)
```

#### Paired-Samples *t*-Test {#sec-statisticalTestsCriticalValuePairedSamplesTtest}

For a paired-samples *t*-test, the degrees of freedom is in @eq-dfPairedSamplesTtest:

$$
df = N - 1
$$ {#eq-dfPairedSamplesTtest}

where $N$ is sample size (i.e., the number of paired observations).

```{r}
df_pairedSamplesTtest <- N - 1
```

One-tailed test:

```{r}
qt(1 - alpha, df_pairedSamplesTtest)
```

Two-tailed test:

```{r}
qt(1 - alpha/2, df_pairedSamplesTtest)
```

#### One-Way ANOVA {#sec-statisticalTestsCriticalValueOneWayANOVA}

For a one-way ANOVA, the degrees of freedom is in @eq-dfOneWayANOVA:

$$
\begin{aligned}
  df_\text{between} &= g - 1 \\
  df_\text{within} &= N - g
\end{aligned}
$$ {#eq-dfOneWayANOVA}

where $N$ is sample size and $g$ is the number of groups.

```{r}
df_betweenOneWayANOVA <- numGroups - 1
df_withinOneWayANOVA <- N - numGroups
```

One-tailed test:

```{r}
qf(1 - alpha, df_betweenOneWayANOVA, df_withinOneWayANOVA)
```

Two-tailed test:

```{r}
qf(1 - alpha/2, df_betweenOneWayANOVA, df_withinOneWayANOVA)
```

#### Factorial ANOVA {#sec-statisticalTestsCriticalValueFactorialANOVA}

For a factorial two-way ANOVA, the degrees of freedom is in @eq-dfFactorialANOVA:

$$
\begin{aligned}
  df_\text{Factor A} &= a - 1 \\
  df_\text{Factor B} &= b - 1 \\
  df_\text{Interaction} &= (a - 1)(b - 1) \\
  df_\text{error} &= ab(N - 1)
\end{aligned}
$$ {#eq-dfFactorialANOVA}

where $N$ is sample size, $a$ is the number of levels for factor A, and $b$ is the number of levels for factor B.

```{r}
df_factorA <- numLevelsFactorA - 1
df_factorB <- numLevelsFactorB - 1
df_interaction <- df_factorA * df_factorB
df_error <- numLevelsFactorA * numLevelsFactorB * (N - 1)
```

Factor A (one-tailed test):

```{r}
qf(1 - alpha, df_factorA, df_error)
```

Factor B (one-tailed test):

```{r}
qf(1 - alpha, df_factorB, df_error)
```

Interaction (one-tailed test):

```{r}
qf(1 - alpha, df_interaction, df_error)
```

Factor A (two-tailed test):

```{r}
qf(1 - alpha/2, df_factorA, df_error)
```

Factor B (two-tailed test):

```{r}
qf(1 - alpha/2, df_factorB, df_error)
```

Interaction (two-tailed test):

```{r}
qf(1 - alpha/2, df_interaction, df_error)
```

#### Repeated Measures ANOVA {#sec-statisticalTestsCriticalValueRMANOVA}

For a repeated measures ANOVA, the degrees of freedom is in @eq-dfRepeatedMeasuresANOVA:

$$
\begin{aligned}
  df_1 &= T - 1 \\
  df_2 &= (T - 1)(N - 1)
\end{aligned}
$$ {#eq-dfRepeatedMeasuresANOVA}

where $N$ is sample size and $T$ is the number of timepoints (or conditions).

```{r}
df1_RMANOVA <- numTimepoints - 1
df2_RMANOVA <- (numTimepoints - 1) * (N - 1)
```

One-tailed test:

```{r}
qf(1 - alpha, df1_RMANOVA, df2_RMANOVA)
```

Two-tailed test:

```{r}
qf(1 - alpha/2, df1_RMANOVA, df2_RMANOVA)
```

#### Correlation {#sec-statisticalTestsCriticalValueCorrelation}

For a correlation, the degrees of freedom is in @eq-dfCorrelation:

$$
df = N - 2
$$ {#eq-dfCorrelation}

where $N$ is sample size.

```{r}
df_correlation <- N - 2
```

One-tailed test:

```{r}
qt(1 - alpha, df_correlation)
```

Two-tailed test:

```{r}
qt(1 - alpha/2, df_correlation)
```

#### Multiple Regression {#sec-statisticalTestsCriticalValueMultipleRegression}

For multiple regression, the degrees of freedom is in @eq-dfMultipleRegression:

$$
\begin{aligned}
  df_1 &= p \\
  df_2 &= N - p - 1
\end{aligned}
$$ {#eq-dfMultipleRegression}

where $N$ is sample size and $p$ is the number of predictors.

```{r}
df1_regression <- numPredictors
df2_regression <- N - numPredictors - 1
```

One-tailed test:

```{r}
qf(1 - alpha, df1_regression, df2_regression)
```

Two-tailed test:

```{r}
qf(1 - alpha/2, df1_regression, df2_regression)
```

#### Chi-Square Goodness-of-Fit Test {#sec-statisticalTestsCriticalValueChiSquareGOF}

For the chi-square goodness-of-fit test, the degrees of freedom is in @eq-dfChiSquareGOF:

$$
df = c - 1
$$ {#eq-dfChiSquareGOF}

where $c$ is the number of categories.

```{r}
df_chisquareGOF <- numCategories - 1
```

One-tailed test:

```{r}
qchisq(1 - alpha, df_chisquareGOF)
```

Two-tailed test:

```{r}
qchisq(1 - alpha/2, df_chisquareGOF)
```

#### Chi-Square Test for Association {#sec-statisticalTestsCriticalValueChiSquareAssociation}

For the chi-square test for association, the degrees of freedom is in @eq-dfChiSquareAssociation:

$$
df = (r - 1) \times (c - 1)
$$ {#eq-dfChiSquareAssociation}

where $r$ is the number of rows in the contingency table and $c$ is the number of columns in the contingency table.

```{r}
df_chisquareAssociation <- (numRows - 1) * (numColumns - 1)
```

One-tailed test:

```{r}
qchisq(1 - alpha, df_chisquareAssociation)
```

Two-tailed test:

```{r}
qchisq(1 - alpha/2, df_chisquareAssociation)
```

### Statistical Power {#sec-statisticalPower}

As described above, *statistical power* is the probability of detecting an effect, if, in fact, the effect exists.
Statistical power for a given test can be calculated based on three factors:

- [effect size](#sec-practicalSignificance)
- sample size
- [alpha level](#sec-statisticalSignificance)

Knowing any three of the following, you can calculate the fourth: statistical power, effect size, sample size, and alpha level.

```{r}
power <- .8
effectSize_d <- .5
effectSize_r <- .24
```

#### One-Sample *t*-Test {#sec-statisticalPowerOneSampleTtest}

Solving for statistical power achieved (given effect size, sample size, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  d = effectSize_d,
  sig.level = alpha,
  type = "one.sample",
  alternative = "two.sided")
```

Solving for sample size needed (given effect size, power, and alpha):

```{r}
pwr::pwr.t.test(
  d = effectSize_d,
  power = power,
  sig.level = alpha,
  type = "one.sample",
  alternative = "two.sided")
```

Solving for minimum effect size needed to detect (given sample size, power, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  power = power,
  sig.level = alpha,
  type = "one.sample",
  alternative = "two.sided")
```

#### Independent-Samples *t*-Test {#sec-statisticalPowerIndependentSamplesTtest}

##### Balanced Group Sizes {#sec-statisticalPowerIndependentSamplesTtestBalanced}

Solving for statistical power achieved (given effect size, sample size per group, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  d = effectSize_d,
  sig.level = alpha,
  type = "two.sample",
  alternative = "two.sided")
```

Solving for sample size per group needed (given effect size, power, and alpha):

```{r}
pwr::pwr.t.test(
  d = effectSize_d,
  power = power,
  sig.level = alpha,
  type = "two.sample",
  alternative = "two.sided")
```

Solving for minimum effect size needed to detect (given sample size per group, power, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  power = power,
  sig.level = alpha,
  type = "two.sample",
  alternative = "two.sided")
```

##### Unbalanced Group Sizes {#sec-statisticalPowerIndependentSamplesTtestUnbalanced}

Solving for statistical power achieved (given effect size, sample size per group, and alpha):

```{r}
pwr::pwr.t2n.test(
  n1 = nGroup1,
  n2 = nGroup2,
  d = effectSize_d,
  sig.level = alpha,
  alternative = "two.sided")
```

Solving for sample size per group needed (given effect size, power, and alpha):

```{r}
pwr::pwr.t2n.test(
  n1 = nGroup1,
  d = effectSize_d,
  power = power,
  sig.level = alpha,
  alternative = "two.sided")
```

Solving for minimum effect size needed to detect (given sample size per group, power, and alpha):

```{r}
pwr::pwr.t2n.test(
  n1 = nGroup1,
  n2 = nGroup2,
  power = power,
  sig.level = alpha,
  alternative = "two.sided")
```

#### Paired-Samples *t*-Test {#sec-statisticalPowerPairedSamplesTtest}

Solving for statistical power achieved (given effect size, sample size per group, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  d = effectSize_d,
  sig.level = alpha,
  type = "paired",
  alternative = "two.sided")
```

Solving for sample size per group needed (given effect size, power, and alpha):

```{r}
pwr::pwr.t.test(
  d = effectSize_d,
  power = power,
  sig.level = alpha,
  type = "paired",
  alternative = "two.sided")
```

Solving for minimum effect size needed to detect (given sample size per group, power, and alpha):

```{r}
pwr::pwr.t.test(
  n = N,
  power = power,
  sig.level = alpha,
  type = "paired",
  alternative = "two.sided")
```

#### One-Way ANOVA {#sec-statisticalPowerOneWayANOVA}

#### Factorial ANOVA {#sec-statisticalPowerFactorialANOVA}

#### Repeated Measures ANOVA {#sec-statisticalPowerRepeatedMeasuresANOVA}

#### Correlation {#sec-statisticalPowerCorrelation}

#### Multiple Regression {#sec-statisticalPowerMultipleRegression}

#### Chi-Square Goodness-of-Fit Test {#sec-statisticalPowerChiSquareGOF}

#### Chi-Square Test for Association {#sec-statisticalPowerChiSquareAssociation}

